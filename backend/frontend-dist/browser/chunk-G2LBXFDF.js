import{a as R}from"./chunk-YL74CBNY.js";import{b as B,c as U,f as N,h as L,m as A,n as j,p as H,q as K}from"./chunk-CRXYTJXZ.js";import{k as F,p as G}from"./chunk-QU66LBKX.js";import{Eb as W,Fa as O,Ia as o,Ib as n,Jb as u,Kb as w,Nb as f,Ob as _,Pb as h,T as k,Ua as z,Y as g,Z as m,a as V,fb as x,gb as b,ia as C,ib as P,jb as v,kb as y,lb as S,mb as t,nb as e,ob as I,sb as D,wb as p,yb as T}from"./chunk-EGMLUSXW.js";function Y(l,s){if(l&1){let r=D();t(0,"div",26),I(1,"img",27),t(2,"button",28),p("click",function(){let d=g(r).$index,c=T(2);return m(c.removeImage(d))}),n(3,"\xD7"),e()()}if(l&2){let r=s.$implicit;o(),S("src","/api/images/"+r,O)}}function $(l,s){if(l&1&&(t(0,"div",8)(1,"h3"),n(2),e(),t(3,"div",25),v(4,Y,4,1,"div",26,P),e()()),l&2){let r=T();o(2),w("Uploaded: ",r.uploadedImages().length," images"),o(2),y(r.uploadedImages())}}function q(l,s){l&1&&n(0," \u23F3 Generating... ")}function J(l,s){l&1&&n(0," \u{1F3B2} Generate Test Data ")}function X(l,s){l&1&&n(0," \u23F3 Cleaning... ")}function Z(l,s){l&1&&n(0," \u{1F5D1}\uFE0F Cleanup Test Data ")}function ee(l,s){if(l&1&&(t(0,"div",21),n(1),e()),l&2){let r=T();o(),u(r.generationProgress())}}function te(l,s){if(l&1&&(t(0,"li")(1,"a",37),n(2),e()()),l&2){let r=s.$implicit;o(),S("href","/world/"+r,O),o(),u(r)}}function ne(l,s){if(l&1&&(t(0,"code"),n(1),e()),l&2){let r=s.$implicit;o(),u(r)}}function ie(l,s){if(l&1&&I(0,"img",36),l&2){let r=s.$implicit;S("src","/api/images/"+r,O)("alt",r)}}function re(l,s){if(l&1&&(t(0,"div",22)(1,"h2"),n(2,"\u2705 Generation Results"),e(),t(3,"div",29)(4,"div",30)(5,"div",31),n(6),e(),t(7,"div",32),n(8,"Characters"),e()(),t(9,"div",30)(10,"div",31),n(11),e(),t(12,"div",32),n(13,"Worlds"),e()(),t(14,"div",30)(15,"div",31),n(16),e(),t(17,"div",32),n(18,"Images"),e()()(),t(19,"div",33)(20,"h3"),n(21,"Generated Worlds:"),e(),t(22,"ul"),v(23,te,3,2,"li",null,P),e(),t(25,"details")(26,"summary"),n(27),e(),t(28,"div",34),v(29,ne,2,1,"code",null,P),e()(),t(31,"details")(32,"summary"),n(33),e(),t(34,"div",35),v(35,ie,1,2,"img",36,P),e()()()()),l&2){let r=T();o(6),u(r.lastResult().created.characters),o(5),u(r.lastResult().created.worlds),o(5),u(r.lastResult().created.images),o(7),y(r.lastResult().worldNames),o(4),w("Character IDs (",r.lastResult().characterIds.length,")"),o(2),y(r.lastResult().characterIds),o(4),w("Image IDs (",r.lastResult().imageIds.length,")"),o(2),y(r.lastResult().imageIds)}}var Q=class l{http=k(G);imageService=k(K);config={characters:100,worlds:5,items:50,spells:30,runes:20,skills:15,battlemaps:10};uploadedImages=C([]);uploadProgress=C("");isGenerating=C(!1);generationProgress=C("");lastResult=C(null);isCleaningUp=C(!1);async onFileSelected(s){let r=s.target;if(!r.files||r.files.length===0)return;this.uploadProgress.set("Uploading images...");let i=Array.from(r.files),d=[];for(let c=0;c<i.length;c++){let a=i[c];this.uploadProgress.set(`Uploading ${c+1}/${i.length}: ${a.name}`);try{let E=await this.fileToBase64(a),M=await this.imageService.uploadImage(E);d.push(M)}catch(E){console.error(`Failed to upload ${a.name}:`,E)}}this.uploadedImages.set([...this.uploadedImages(),...d]),this.uploadProgress.set(`Uploaded ${d.length} images`),r.value=""}fileToBase64(s){return new Promise((r,i)=>{let d=new FileReader;d.onload=()=>r(d.result),d.onerror=i,d.readAsDataURL(s)})}removeImage(s){let r=[...this.uploadedImages()];r.splice(s,1),this.uploadedImages.set(r)}async generateTestData(){if(!this.isGenerating()){this.isGenerating.set(!0),this.generationProgress.set("Starting generation..."),this.lastResult.set(null);try{let s=V({},this.config);this.uploadedImages().length>0&&(s.imageIds=this.uploadedImages()),this.generationProgress.set("Generating characters, worlds, and items...");let r=await this.http.post("/api/stress-test/generate",s).toPromise();r&&(this.lastResult.set(r),this.generationProgress.set("\u2705 Generation complete!"))}catch(s){console.error("Stress test generation failed:",s),this.generationProgress.set("\u274C Generation failed - check console")}finally{this.isGenerating.set(!1)}}}async cleanupTestData(){if(!(this.isCleaningUp()||!confirm("This will delete all stress test data (characters starting with stress_char_ and worlds starting with StressWorld_). Continue?"))){this.isCleaningUp.set(!0),this.generationProgress.set("Cleaning up test data...");try{let s=await this.http.delete("/api/stress-test/cleanup").toPromise();s&&(this.generationProgress.set(`\u2705 Deleted ${s.deleted.characters} characters, ${s.deleted.worlds} worlds`),this.lastResult.set(null))}catch(s){console.error("Cleanup failed:",s),this.generationProgress.set("\u274C Cleanup failed - check console")}finally{this.isCleaningUp.set(!1)}}}loadPresetSmall(){this.config={characters:10,worlds:1,items:20,spells:10,runes:10,skills:5,battlemaps:2}}loadPresetMedium(){this.config={characters:100,worlds:5,items:50,spells:30,runes:20,skills:15,battlemaps:10}}loadPresetLarge(){this.config={characters:500,worlds:20,items:200,spells:100,runes:80,skills:50,battlemaps:30}}loadPresetExtreme(){this.config={characters:2e3,worlds:50,items:500,spells:300,runes:200,skills:150,battlemaps:100}}get estimatedDataSize(){let M=this.config.characters*5+this.config.worlds*(10+this.config.items*.5+this.config.spells*.5+this.config.runes*.5+this.config.skills*.3+this.config.battlemaps*2);return M<1024?`~${Math.round(M)} KB`:`~${(M/1024).toFixed(1)} MB`}get totalEntities(){return this.config.characters+this.config.worlds+this.config.worlds*(this.config.items+this.config.spells+this.config.runes+this.config.skills+this.config.battlemaps)}static \u0275fac=function(r){return new(r||l)};static \u0275cmp=z({type:l,selectors:[["app-stress-test"]],decls:103,vars:17,consts:[["fileInput",""],[1,"stress-test-container"],[1,"subtitle"],[1,"section"],[1,"upload-area"],["type","file","id","imageUpload","accept","image/*","multiple","",2,"display","none",3,"change"],[1,"btn","btn-primary",3,"click"],[1,"upload-status"],[1,"uploaded-images"],[1,"preset-buttons"],[1,"btn",3,"click"],[1,"btn","btn-danger",3,"click"],[1,"config-grid"],[1,"config-item"],["type","number","min","0","max","10000",3,"ngModelChange","ngModel"],["type","number","min","0","max","100",3,"ngModelChange","ngModel"],["type","number","min","0","max","1000",3,"ngModelChange","ngModel"],["type","number","min","0","max","500",3,"ngModelChange","ngModel"],[1,"stats"],[1,"btn","btn-success","btn-large",3,"click","disabled"],[1,"btn","btn-danger","btn-large",3,"click","disabled"],[1,"progress-message"],[1,"section","results"],[1,"section","instructions"],[1,"warning"],[1,"image-list"],[1,"image-item"],["alt","Test image",3,"src"],[1,"btn-remove",3,"click"],[1,"result-grid"],[1,"result-item"],[1,"result-number"],[1,"result-label"],[1,"result-details"],[1,"character-ids"],[1,"image-ids"],[3,"src","alt"],["target","_blank",3,"href"]],template:function(r,i){if(r&1){let d=D();t(0,"div",1)(1,"app-card")(2,"h1"),n(3,"\u{1F525} Performance Stress Test Generator"),e(),t(4,"p",2),n(5,"Generate massive amounts of test data to stress test the entire system"),e(),t(6,"div",3)(7,"h2"),n(8,"\u{1F4F8} Test Images (Optional)"),e(),t(9,"p"),n(10,"Upload images to use for character portraits, spells, runes, and battlemap tokens. If none provided, system will use default colored pixels."),e(),t(11,"div",4)(12,"input",5,0),p("change",function(a){return g(d),m(i.onFileSelected(a))}),e(),t(14,"button",6),p("click",function(){g(d);let a=W(13);return m(a.click())}),n(15," \u{1F4E4} Upload Images "),e(),t(16,"span",7),n(17),e()(),x(18,$,6,1,"div",8),e(),t(19,"div",3)(20,"h2"),n(21,"\u26A1 Quick Presets"),e(),t(22,"div",9)(23,"button",10),p("click",function(){return g(d),m(i.loadPresetSmall())}),n(24,"Small (10 chars)"),e(),t(25,"button",10),p("click",function(){return g(d),m(i.loadPresetMedium())}),n(26,"Medium (100 chars)"),e(),t(27,"button",10),p("click",function(){return g(d),m(i.loadPresetLarge())}),n(28,"Large (500 chars)"),e(),t(29,"button",11),p("click",function(){return g(d),m(i.loadPresetExtreme())}),n(30,"\u{1F525} Extreme (2000 chars)"),e()()(),t(31,"div",3)(32,"h2"),n(33,"\u2699\uFE0F Configuration"),e(),t(34,"div",12)(35,"div",13)(36,"label"),n(37,"Characters:"),e(),t(38,"input",14),h("ngModelChange",function(a){return g(d),_(i.config.characters,a)||(i.config.characters=a),m(a)}),e()(),t(39,"div",13)(40,"label"),n(41,"Worlds:"),e(),t(42,"input",15),h("ngModelChange",function(a){return g(d),_(i.config.worlds,a)||(i.config.worlds=a),m(a)}),e()(),t(43,"div",13)(44,"label"),n(45,"Items (per world):"),e(),t(46,"input",16),h("ngModelChange",function(a){return g(d),_(i.config.items,a)||(i.config.items=a),m(a)}),e()(),t(47,"div",13)(48,"label"),n(49,"Spells (per world):"),e(),t(50,"input",17),h("ngModelChange",function(a){return g(d),_(i.config.spells,a)||(i.config.spells=a),m(a)}),e()(),t(51,"div",13)(52,"label"),n(53,"Runes (per world):"),e(),t(54,"input",17),h("ngModelChange",function(a){return g(d),_(i.config.runes,a)||(i.config.runes=a),m(a)}),e()(),t(55,"div",13)(56,"label"),n(57,"Skills (per world):"),e(),t(58,"input",17),h("ngModelChange",function(a){return g(d),_(i.config.skills,a)||(i.config.skills=a),m(a)}),e()(),t(59,"div",13)(60,"label"),n(61,"Battlemaps (per world):"),e(),t(62,"input",15),h("ngModelChange",function(a){return g(d),_(i.config.battlemaps,a)||(i.config.battlemaps=a),m(a)}),e()()(),t(63,"div",18)(64,"p")(65,"strong"),n(66,"Total Entities:"),e(),n(67),e(),t(68,"p")(69,"strong"),n(70,"Estimated Size:"),e(),n(71),e()()(),t(72,"div",3)(73,"h2"),n(74,"\u{1F680} Actions"),e(),t(75,"button",19),p("click",function(){return g(d),m(i.generateTestData())}),x(76,q,1,0)(77,J,1,0),e(),t(78,"button",20),p("click",function(){return g(d),m(i.cleanupTestData())}),x(79,X,1,0)(80,Z,1,0),e(),x(81,ee,2,1,"div",21),e(),x(82,re,37,5,"div",22),t(83,"div",23)(84,"h2"),n(85,"\u{1F4D6} How to Use"),e(),t(86,"ol")(87,"li")(88,"strong"),n(89,"Optional:"),e(),n(90," Upload custom images to use for portraits and drawings"),e(),t(91,"li"),n(92,"Choose a preset or configure custom entity counts"),e(),t(93,"li"),n(94,'Click "Generate Test Data" to create all entities'),e(),t(95,"li"),n(96,"Navigate to generated worlds to test performance"),e(),t(97,"li"),n(98,'Click "Cleanup Test Data" when done to remove all test entities'),e()(),t(99,"div",24)(100,"strong"),n(101,"\u26A0\uFE0F Warning:"),e(),n(102,' The "Extreme" preset generates 2000+ characters and massive amounts of data. This may take several minutes and could impact performance during generation. '),e()()()()}r&2&&(o(17),u(i.uploadProgress()),o(),b(i.uploadedImages().length>0?18:-1),o(20),f("ngModel",i.config.characters),o(4),f("ngModel",i.config.worlds),o(4),f("ngModel",i.config.items),o(4),f("ngModel",i.config.spells),o(4),f("ngModel",i.config.runes),o(4),f("ngModel",i.config.skills),o(4),f("ngModel",i.config.battlemaps),o(5),w(" ",i.totalEntities),o(4),w(" ",i.estimatedDataSize),o(4),S("disabled",i.isGenerating()),o(),b(i.isGenerating()?76:77),o(2),S("disabled",i.isCleaningUp()||i.isGenerating()),o(),b(i.isCleaningUp()?79:80),o(2),b(i.generationProgress()?81:-1),o(),b(i.lastResult()?82:-1))},dependencies:[F,H,B,L,U,j,A,N,R],styles:[".stress-test-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.subtitle[_ngcontent-%COMP%]{color:#666;font-size:14px;margin-top:-10px}.section[_ngcontent-%COMP%]{margin:30px 0;padding:20px;background:#f8f9fa;border-radius:8px}.section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;color:#333}.upload-area[_ngcontent-%COMP%]{display:flex;gap:15px;align-items:center;margin:15px 0}.upload-status[_ngcontent-%COMP%]{color:#666;font-size:14px}.uploaded-images[_ngcontent-%COMP%]{margin-top:20px}.image-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}.image-item[_ngcontent-%COMP%]{position:relative;width:80px;height:80px;border:2px solid #ddd;border-radius:4px;overflow:hidden}.image-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.btn-remove[_ngcontent-%COMP%]{position:absolute;top:2px;right:2px;background:#f00c;color:#fff;border:none;border-radius:50%;width:24px;height:24px;cursor:pointer;font-size:18px;line-height:1;padding:0}.btn-remove[_ngcontent-%COMP%]:hover{background:red}.preset-buttons[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap}.config-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin:20px 0}.config-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.config-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#555}.config-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #ddd;border-radius:4px;font-size:16px}.config-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff}.stats[_ngcontent-%COMP%]{margin-top:20px;padding:15px;background:#fff;border-radius:4px;border-left:4px solid #007bff}.stats[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-size:14px;font-weight:600;transition:all .2s}.btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 8px #0003}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#0056b3}.btn-success[_ngcontent-%COMP%]{background:#28a745;color:#fff}.btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background:#218838}.btn-danger[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#c82333}.btn-large[_ngcontent-%COMP%]{padding:15px 30px;font-size:16px;margin-right:15px;margin-bottom:15px}.progress-message[_ngcontent-%COMP%]{margin-top:15px;padding:15px;background:#e9ecef;border-radius:4px;font-weight:600;font-size:16px}.results[_ngcontent-%COMP%]{background:#d4edda;border-left:4px solid #28a745}.result-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:20px;margin:20px 0}.result-item[_ngcontent-%COMP%]{text-align:center;padding:20px;background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.result-number[_ngcontent-%COMP%]{font-size:48px;font-weight:700;color:#28a745}.result-label[_ngcontent-%COMP%]{font-size:14px;color:#666;margin-top:5px}.result-details[_ngcontent-%COMP%]{margin-top:20px}.result-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:10px}.result-details[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.result-details[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:5px 0}.result-details[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#007bff;text-decoration:none}.result-details[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.result-details[_ngcontent-%COMP%]   details[_ngcontent-%COMP%]{margin-top:15px;padding:10px;background:#fff;border-radius:4px}.result-details[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{cursor:pointer;font-weight:600;padding:5px}.result-details[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]:hover{background:#f8f9fa}.character-ids[_ngcontent-%COMP%], .image-ids[_ngcontent-%COMP%]{margin-top:10px;padding:10px;background:#f8f9fa;border-radius:4px;max-height:300px;overflow-y:auto}.character-ids[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{display:inline-block;margin:5px;padding:5px 10px;background:#fff;border:1px solid #ddd;border-radius:3px;font-size:12px}.image-ids[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px}.image-ids[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px;height:60px;object-fit:cover;border:2px solid #ddd;border-radius:4px}.instructions[_ngcontent-%COMP%]{background:#fff3cd;border-left:4px solid #ffc107}.instructions[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{padding-left:20px}.instructions[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:10px 0}.warning[_ngcontent-%COMP%]{margin-top:20px;padding:15px;background:#f8d7da;border:1px solid #f5c6cb;border-radius:4px;color:#721c24}"]})};export{Q as StressTestComponent};
