import{a as de,c as Se}from"./chunk-RFXIYJE6.js";import{b as G}from"./chunk-U2QMYJWS.js";import{a as X,b as V,c as A,d as we,e as ke,f as F,g as ye,h as J,j as oe,k as se,l as le,n as Q,o as Me,p as N,q as ce}from"./chunk-CRXYTJXZ.js";import{k as B}from"./chunk-QU66LBKX.js";import{$b as q,Bb as ie,Cb as re,Db as ae,Ea as L,Fa as Y,Fb as H,Gb as b,Ia as l,Ib as c,Jb as T,Kb as y,Lb as ve,Nb as x,O as xe,Ob as v,Pb as w,Qa as S,Ua as I,Ub as U,Vb as Z,Y as p,Z as g,a as be,b as Ce,da as k,db as ne,fb as h,g as te,gb as f,ia as P,ib as z,jb as D,kb as R,lb as u,mb as r,nb as a,ob as M,sb as C,wb as m,yb as d}from"./chunk-EGMLUSXW.js";var pe=class{name;bonus;base;gain;current;effectBonus;constructor(t,e,n=0,i=0){this.base=e,this.gain=n,this.bonus=i,this.name=t,this.current=1,this.effectBonus=0}};function Vt(){return{name:"",race:"",age:0,alignment:"",size:"",extrainfo:"",primary_class:"",secondary_class:"",level:1,learned_classes:"",strength:$("St\xE4rke"),dexterity:$("Geschicklichkeit"),speed:$("Geschwindigkeit"),intelligence:$("Intelligenz"),chill:$("Chill"),constitution:$("Konstitution"),skills:[],inventory:[],equipment:[],carryCapacityMultiplier:1,carryCapacityBonus:0,statuses:Fe(),runes:[],spells:[],fokusMultiplier:1,fokusBonus:0,currency:{copper:0,silver:0,gold:0,platinum:0},trash:[],talentPoints:0,talentPointsBonus:0,learnedSkillIds:[],backstory:""}}function $(s){return new pe(s,10,5,0)}function Fe(){return[{statusName:"Leben",statusColor:"red",statusBase:80,statusBonus:0,statusCurrent:80,formulaType:"LIFE"},{statusName:"Ausdauer",statusColor:"green",statusBase:50,statusBonus:0,statusCurrent:50,formulaType:"ENERGY"},{statusName:"Mana",statusColor:"blue",statusBase:40,statusBonus:0,statusCurrent:40,formulaType:"MANA"}]}var Pe=class s{socket;patchSubject=new te;lootReceivedSubject=new te;battleLootReceivedSubject=new te;patches$=this.patchSubject.asObservable();lootReceived$=this.lootReceivedSubject.asObservable();battleLootReceived$=this.battleLootReceivedSubject.asObservable();connect(){this.socket||(this.socket=Se(window.location.origin,{path:"/socket.io",transports:["websocket"]}),this.socket.on("characterPatched",t=>{this.patchSubject.next(t)}),this.socket.on("lootReceived",t=>{this.lootReceivedSubject.next(t)}),this.socket.on("battleLootReceived",t=>{this.battleLootReceivedSubject.next(t)}))}joinCharacter(t){this.socket?.emit("joinCharacter",t)}sendPatch(t,e){console.log("Sending patch "+JSON.stringify(e)),this.socket?.emit("patchCharacter",{characterId:t,patch:e})}static \u0275fac=function(e){return new(e||s)};static \u0275prov=xe({token:s,factory:s.\u0275fac,providedIn:"root"})};var Oe={Magier:{tier:1,angle:90,children:[{className:"Kampfzauberer",angle:114},{className:"Heiler",angle:67}]},K\u00E4mpfer:{tier:1,angle:-41,children:[{className:"Krieger",angle:-14},{className:"Barbar",angle:-58}]},Techniker:{tier:1,angle:-147,children:[{className:"Sch\xFCtze",angle:-165},{className:"Dieb",angle:-125}]},Kampfzauberer:{tier:2,angle:114,children:[{className:"Arkanist",angle:123},{className:"H\xE4monant",angle:90}]},Heiler:{tier:2,angle:67,children:[{className:"Seelenmagier",angle:65},{className:"Paladin",angle:26}]},Sch\u00FCtze:{tier:2,angle:-165,children:[{className:"J\xE4ger",angle:-160},{className:"Schnellsch\xFCtze",angle:-179}]},Dieb:{tier:2,angle:-125,children:[{className:"Kampfakrobat",angle:-131},{className:"Assassine",angle:-151}]},Krieger:{tier:2,angle:-14,children:[{className:"Ritter",angle:-1},{className:"M\xF6nch",angle:-35}]},Barbar:{tier:2,angle:-58,children:[{className:"Berserker",angle:-68},{className:"Pl\xFCnderer",angle:-96}]},Arkanist:{tier:3,angle:123,children:[{className:"Formationsmagier",angle:127},{className:"Phantom",angle:-174},{className:"Runenk\xFCnstler",angle:104}]},H\u00E4monant:{tier:3,angle:90,children:[{className:"Nekromant",angle:83}]},Seelenmagier:{tier:3,angle:65,children:[{className:"Gestaltenwandler",angle:55},{className:"Mentalist",angle:71}]},J\u00E4ger:{tier:3,angle:-160,children:[{className:"Attent\xE4ter",angle:-155}]},Kampfakrobat:{tier:3,angle:-131,children:[{className:"Klingent\xE4nzer",angle:-136},{className:"Duellant",angle:-116},{className:"Phantom",angle:-174}]},Ritter:{tier:3,angle:-1,children:[{className:"Erzritter",angle:14},{className:"Paladin",angle:26},{className:"W\xE4chter",angle:-1}]},Berserker:{tier:3,angle:-68,children:[{className:"Kriegsherr",angle:-92},{className:"Omen",angle:-51}]},Pl\u00FCnderer:{tier:3,angle:-96,children:[{className:"General",angle:-94}]},M\u00F6nch:{tier:3,angle:-35,children:[{className:"Templer",angle:-42}]},Schnellsch\u00FCtze:{tier:3,angle:-179,children:[{className:"Artificer",angle:157}]},Phantom:{tier:4,angle:-174,children:[]},Gestaltenwandler:{tier:4,angle:55,children:[]},Formationsmagier:{tier:4,angle:127,children:[{className:"Manalord",angle:118},{className:"Artificer",angle:157}]},Runenk\u00FCnstler:{tier:4,angle:104,children:[{className:"Manalord",angle:118},{className:"Dunkler Ritter",angle:24}]},Mentalist:{tier:4,angle:71,children:[{className:"Orakel",angle:67},{className:"Nekromant",angle:83}]},Assassine:{tier:4,angle:-151,children:[{className:"Attent\xE4ter",angle:-155}]},Klingent\u00E4nzer:{tier:4,angle:-136,children:[{className:"Waffenmeister",angle:-138}]},Erzritter:{tier:4,angle:14,children:[{className:"W\xE4chter",angle:-1},{className:"Dunkler Ritter",angle:24}]},General:{tier:4,angle:-94,children:[{className:"Kriegsherr",angle:-92}]},Paladin:{tier:4,angle:26,children:[]},Templer:{tier:4,angle:-42,children:[{className:"Koloss",angle:-30},{className:"Omen",angle:-51}]},Manalord:{tier:5,angle:118,children:[]},Artificer:{tier:5,angle:157,children:[]},Attent\u00E4ter:{tier:5,angle:-155,children:[]},Duellant:{tier:5,angle:-116,children:[]},Waffenmeister:{tier:5,angle:-138,children:[]},Kriegsherr:{tier:5,angle:-92,children:[]},Omen:{tier:5,angle:-51,children:[]},Koloss:{tier:5,angle:-30,children:[]},W\u00E4chter:{tier:5,angle:-1,children:[]},"Dunkler Ritter":{tier:5,angle:24,children:[]},Orakel:{tier:5,angle:67,children:[]},Nekromant:{tier:5,angle:83,children:[]}},fe=[{id:"magier_int_1",name:"Intelligenz+1",class:"Magier",type:"stat_bonus",description:"+1 Intelligenz",enlightened:!1,statBonus:{stat:"intelligence",amount:1}},{id:"magier_mana_15",name:"Mana+15",class:"Magier",type:"stat_bonus",description:"+15 Mana",enlightened:!1,statBonus:{stat:"mana",amount:15}},{id:"magier_fokus_1",name:"Fokus+1",class:"Magier",type:"stat_bonus",description:"+1 Fokus",enlightened:!1,statBonus:{stat:"focus",amount:1}},{id:"magier_exzellenz",name:"Exzellenz",class:"Magier",type:"dice_bonus",description:"+1 auf Zauber mit voller Mana",enlightened:!1},{id:"magier_zauberlehrling",name:"Zauberlehrling",class:"Magier",type:"passive",description:"+2 Effektivit\xE4t auf Zauber",enlightened:!1},{id:"kampfzauberer_int_2",name:"Intelligenz+2",class:"Kampfzauberer",type:"stat_bonus",description:"+2 Intelligenz",enlightened:!1,statBonus:{stat:"intelligence",amount:2}},{id:"kampfzauberer_zauberladung",name:"Zauberladung",class:"Kampfzauberer",type:"dice_bonus",description:"+2 beim W\xFCrfeln f\xFCr Zaubercasts",enlightened:!1},{id:"kampfzauberer_verinnerlichen",name:"Verinnerlichen",class:"Kampfzauberer",type:"passive",description:"Lerne einen Zauber auswendig, damit du ihn ohne Medium benutzen kannst. Zauber k\xF6nnen jederzeit gewechselt werden, brauchen aber mehrere Stunden.",enlightened:!1},{id:"kampfzauberer_freies_wirken",name:"Freies Wirken",class:"Kampfzauberer",type:"passive",description:"Kann sich w\xE4hrend eines Zaubercasts bewegen",enlightened:!0},{id:"kampfzauberer_manatransfer",name:"Manatransfer",class:"Kampfzauberer",type:"active",description:"Konvertiert 1x Ausdauer zu 0,8x Mana (wird gerundet)",enlightened:!1,cost:{type:"energy",amount:0}},{id:"kampfzauberer_manadisruption",name:"Manadisruption",class:"Kampfzauberer",type:"active",description:"Reduziere den Castwert des Spells eines Gegners in 20m Umfeld um eine gew\xFCrfelte Anzahl. Boni f\xFCr Zaubercasts werden hier auch angewandt.",enlightened:!1,cost:{type:"mana",amount:5},bonusAction:!0},{id:"heiler_mana_30",name:"Mana+30",class:"Heiler",type:"stat_bonus",description:"+30 Mana",enlightened:!1,statBonus:{stat:"mana",amount:30}},{id:"heiler_gesundheitscheck",name:"Gesundheitscheck",class:"Heiler",type:"dice_bonus",description:"+4 auf Untersuchung von Gesundheit",enlightened:!1},{id:"heiler_notarzt",name:"Notarzt",class:"Heiler",type:"dice_bonus",description:"+3 auf alle Heilungsw\xFCrfe, wenn Ziel im kritischen Zustand ist",enlightened:!1},{id:"heiler_alchemist",name:"Alchemist",class:"Heiler",type:"dice_bonus",description:"+2 beim Brauen von Tr\xE4nken mit positivem Effekt",enlightened:!1},{id:"heiler_regenbogen",name:"Regenbogen",class:"Heiler",type:"passive",description:"Manakosten -20% auf pure Heilzauber",enlightened:!0},{id:"heiler_einfachheit",name:"Einfachheit",class:"Heiler",type:"passive",description:"-2 Voraussetzung auf Heilzauber",enlightened:!0},{id:"heiler_gruppencast",name:"Gruppencast",class:"Heiler",type:"active",description:"Helfe einem Verb\xFCndeten beim Zaubercast, indem du f\xFCr seinen Castwert w\xFCrfelst. Boni f\xFCr Zaubercasts werden hier auch angewandt.",enlightened:!1,cost:{type:"mana",amount:0}},{id:"arkanist_mana_40",name:"Mana+40",class:"Arkanist",type:"stat_bonus",description:"+40 Mana",enlightened:!1,statBonus:{stat:"mana",amount:40}},{id:"arkanist_zauberradius",name:"Zauberradius+1m",class:"Arkanist",type:"stat_bonus",description:"+1m Zauberradius",enlightened:!1,statBonus:{stat:"spellRadius",amount:1}},{id:"arkanist_managespuer",name:"Managesp\xFCr",class:"Arkanist",type:"passive",description:"Kann pures Mana sp\xFCren",enlightened:!1},{id:"arkanist_verinnerlichen_plus",name:"+Verinnerlichen",class:"Arkanist",type:"passive",description:"Besetze je 5 Fokus, um einen zus\xE4tzlichen Zauber auswendig zu lernen.",enlightened:!1,requiresSkill:"kampfzauberer_verinnerlichen"},{id:"arkanist_schmagied",name:"Schmagied",class:"Arkanist",type:"passive",description:"Halbiert Voraussetzungen von selbst gebauten Zaubern.",enlightened:!0},{id:"arkanist_zauberbrecher",name:"Zauberbrecher",class:"Arkanist",type:"active",description:"Annulliert einen Zauber im Zauberradius, Ausdauerkosten entsprechen den halben Manakosten des Zaubers und kann Ausdauer ins Negative bringen",enlightened:!1,cost:{type:"energy",amount:0}},{id:"arkanist_ueberladen",name:"\xDCberladen",class:"Arkanist",type:"active",description:"Nutze einen Zauber mit verdoppelter Voraussetzung und Effektivit\xE4t.",enlightened:!1,cost:{type:"mana",amount:10}},{id:"haemonant_leben_40",name:"Leben+40",class:"H\xE4monant",type:"stat_bonus",description:"+40 Leben",enlightened:!1,statBonus:{stat:"life",amount:40}},{id:"haemonant_magisches_blut",name:"Magisches Blut",class:"H\xE4monant",type:"passive",description:"Kann eigenes Blut als Startpunkt f\xFCr Zauber benutzen",enlightened:!1},{id:"haemonant_kaltbluetig",name:"Kaltbl\xFCtig",class:"H\xE4monant",type:"dice_bonus",description:"+1 im Kampf gegen Gegner mit offenen Wunden",enlightened:!1},{id:"haemonant_transfusion",name:"Transfusion",class:"H\xE4monant",type:"active",description:"Absorbiere umliegendes Blut und heile dich um den gew\xFCrfelten Betrag (D8).",enlightened:!1,cost:{type:"mana",amount:5},bonusAction:!0},{id:"haemonant_blutecho",name:"Blutecho",class:"H\xE4monant",type:"active",description:"Absorbiert einen genannten Skill aus gegnerischem Blut und verwende ihn direkt ohne Kosten. Sollte der genannte Skill nicht existieren, wird ein zuf\xE4lliger Skill ausgew\xE4hlt. Nur einmal pro Person m\xF6glich.",enlightened:!1,cost:{type:"mana",amount:20}},{id:"haemonant_hypertonie",name:"Hypertonie",class:"H\xE4monant",type:"active",description:"+2 im Kampf",enlightened:!0,cost:{type:"life",amount:20,perRound:!0}},{id:"haemonant_aderlass",name:"Aderlass",class:"H\xE4monant",type:"active",description:"Konvertiert 1x Leben zu 0,8x Mana (wird abgerundet)",enlightened:!0,cost:{type:"life",amount:0}},{id:"seelenmagier_fokus_4",name:"Fokus+4",class:"Seelenmagier",type:"stat_bonus",description:"+4 Fokus",enlightened:!1,statBonus:{stat:"focus",amount:4}},{id:"seelenmagier_runenkonvergenz",name:"Runenkonvergenz",class:"Seelenmagier",type:"dice_bonus",description:"+1 auf Nutzung von Zaubern die eine Elementarrune beinhalten, die f\xFCr eine aktive Beschw\xF6rung benutzt wurde.",enlightened:!1},{id:"seelenmagier_hausgemacht",name:"Hausgemacht",class:"Seelenmagier",type:"passive",description:"Senkt Fokuskosten f\xFCr selbst kreierte Seelenrunen in Beschw\xF6rungszaubern um 20%.",enlightened:!0},{id:"seelenmagier_seelenwacht",name:"Seelenwacht",class:"Seelenmagier",type:"active",description:"Kann Seelen von Tieren analysieren, um sie als Rune zu speichern. Ben\xF6tigt mehrere Tage intensiver Inspektion.",enlightened:!1,cost:{type:"mana",amount:0}},{id:"seelenmagier_erweitertes_bewusstsein",name:"Erweitertes Bewusstsein",class:"Seelenmagier",type:"active",description:"Reduziert Ausdauer auf 0, um den maximalen Fokus zu verdreifachen. Muss deaktiviert werden, um Ausdauer zu regenerieren.",enlightened:!1,cost:{type:"energy",amount:30},bonusAction:!0},{id:"seelenmagier_adlerauge",name:"Adlerauge",class:"Seelenmagier",type:"active",description:"Nutze die Wahrnehmung einer deiner Beschw\xF6rungen als deine eigene",enlightened:!1,cost:{type:"mana",amount:10,perRound:!0}},{id:"seelenmagier_sanktum",name:"Sanktum",class:"Seelenmagier",type:"active",description:"Festige die Seele eines Verb\xFCndeten, was ihn immun gegen psychische Angriffe macht.",enlightened:!0,cost:{type:"mana",amount:10,perRound:!0},bonusAction:!0},{id:"formationsmagier_fokus_5",name:"Fokus+5",class:"Formationsmagier",type:"stat_bonus",description:"+5 Fokus",enlightened:!1,statBonus:{stat:"focus",amount:5}},{id:"formationsmagier_max_castwert",name:"Maximaler Castwert+200",class:"Formationsmagier",type:"stat_bonus",description:"+200 Maximaler Castwert",enlightened:!1,statBonus:{stat:"maxCastValue",amount:200}},{id:"formationsmagier_zauberarchitekt",name:"Zauberarchitekt",class:"Formationsmagier",type:"passive",description:"Halbiert Fokuskosten von Zaubern mit einer Voraussetzung von \xFCber 100.",enlightened:!1},{id:"formationsmagier_magische_rueckkopplung",name:"Magische R\xFCckkopplung",class:"Formationsmagier",type:"passive",description:"Kann objektgebundene Zauber als Bonusaktion verwenden, verbraucht aber x10 Haltbarkeit.",enlightened:!0},{id:"formationsmagier_arkane_resonanz",name:"Arkane Resonanz",class:"Formationsmagier",type:"passive",description:"Muss bei Formationen (gro\xDFen Spells) keine zus\xE4tzlichen Manakosten zahlen.",enlightened:!0},{id:"formationsmagier_vorbereiten",name:"Vorbereiten",class:"Formationsmagier",type:"dice_bonus",description:"+5 beim W\xFCrfeln f\xFCr Zaubercasts, deren Maximum bei 50 oder h\xF6her liegt",enlightened:!1},{id:"formationsmagier_dunkles_siegel",name:"Dunkles Siegel",class:"Formationsmagier",type:"active",description:"+10 auf den n\xE4chsten Zauber, danach kann einen Tag keine Magie mehr benutzt werden, ignoriert W\xFCrfelbonuslimit",enlightened:!1,cost:{type:"mana",amount:10}},{id:"kaempfer_staerke_1",name:"St\xE4rke+1",class:"K\xE4mpfer",type:"stat_bonus",description:"+1 St\xE4rke",enlightened:!1,statBonus:{stat:"strength",amount:1}},{id:"kaempfer_konstitution_1",name:"Konstitution+1",class:"K\xE4mpfer",type:"stat_bonus",description:"+1 Konstitution",enlightened:!1,statBonus:{stat:"constitution",amount:1}},{id:"kaempfer_schwere_waffen_werfen",name:"Schwere Waffen werfen+1",class:"K\xE4mpfer",type:"dice_bonus",description:"+1 auf Schwere Waffen werfen",enlightened:!1},{id:"kaempfer_backpacker",name:"Backpacker",class:"K\xE4mpfer",type:"passive",description:"+30 Inventarkapazit\xE4t",enlightened:!1},{id:"kaempfer_fester_stand",name:"Fester Stand",class:"K\xE4mpfer",type:"passive",description:"+1 gegen R\xFCcksto\xDF",enlightened:!1},{id:"techniker_geschick_1",name:"Geschicklichkeit+1",class:"Techniker",type:"stat_bonus",description:"+1 Geschicklichkeit",enlightened:!1,statBonus:{stat:"dexterity",amount:1}},{id:"techniker_tempo_1",name:"Geschwindigkeit+1",class:"Techniker",type:"stat_bonus",description:"+1 Geschwindigkeit",enlightened:!1,statBonus:{stat:"speed",amount:1}},{id:"techniker_ausdauer_15",name:"Ausdauer+15",class:"Techniker",type:"stat_bonus",description:"+15 Ausdauer",enlightened:!1,statBonus:{stat:"energy",amount:15}},{id:"techniker_springen",name:"Springen+2",class:"Techniker",type:"dice_bonus",description:"+2 auf Springen",enlightened:!1},{id:"techniker_leichte_waffen_werfen",name:"Leichte Waffen werfen+1",class:"Techniker",type:"dice_bonus",description:"+1 auf Leichte Waffen werfen",enlightened:!1},{id:"krieger_konstitution_2",name:"Konstitution+2",class:"Krieger",type:"stat_bonus",description:"+2 Konstitution",enlightened:!1,statBonus:{stat:"constitution",amount:2}},{id:"krieger_statusresistenz",name:"Statusresistenz",class:"Krieger",type:"passive",description:"Schaden von negativen Effekten gegen dich werden halbiert",enlightened:!0},{id:"krieger_harter_bursche",name:"Harter Bursche",class:"Krieger",type:"dice_bonus",description:"+1, um aus Bewusstlosigkeit zu erwachen",enlightened:!1},{id:"krieger_aetherkraft",name:"\xC4therkraft",class:"Krieger",type:"active",description:"Halbiert Schaden. 10 Mana pro Runde",enlightened:!1,cost:{type:"mana",amount:10,perRound:!0}},{id:"krieger_schwerer_schlag",name:"Schwerer Schlag",class:"Krieger",type:"active",description:"Schlag mit hoher St\xE4rke, muss eine Runde ausholen",enlightened:!0,cost:{type:"energy",amount:20}},{id:"krieger_defensive_haltung",name:"Defensive Haltung",class:"Krieger",type:"active",description:"Reduziert erlittenen Schaden von Fernkampfwaffen stark, kann aber nicht angreifen, 20 pro Runde",enlightened:!1,cost:{type:"energy",amount:20,perRound:!0}},{id:"barbar_staerke_2",name:"St\xE4rke+2",class:"Barbar",type:"stat_bonus",description:"+2 St\xE4rke",enlightened:!1,statBonus:{stat:"strength",amount:2}},{id:"barbar_ruecksichtslos",name:"R\xFCcksichtslos",class:"Barbar",type:"passive",description:"St\xE4rke+4 bei weniger als 5 R\xFCstungsmalus",enlightened:!1},{id:"barbar_blutlust",name:"Blutlust",class:"Barbar",type:"dice_bonus",description:"+1 auf Angriffe f\xFCr jeden get\xF6ten Gegner, h\xE4lt f\xFCr den Rest des Kampfes, maximal +3",enlightened:!1},{id:"barbar_muskelprotz",name:"Muskelprotz",class:"Barbar",type:"dice_bonus",description:"+1 auf Angriffe mit schweren Waffen",enlightened:!0},{id:"barbar_waffenweitwurf",name:"Waffenweitwurf",class:"Barbar",type:"active",description:"Wirft schwere Waffe mit hoher Genauigkeit auf weit entfernte Gegner, maximal 50m",enlightened:!0,cost:{type:"energy",amount:25}},{id:"barbar_kampfschrei",name:"Kampfschrei",class:"Barbar",type:"active",description:"Erh\xF6ht Bewegung aller Verb\xFCndeter um 3 in der N\xE4he f\xFCr einen Zug. Bonusaktion",enlightened:!1,cost:{type:"energy",amount:10},bonusAction:!0},{id:"dieb_tempo_2",name:"Geschwindigkeit+2",class:"Dieb",type:"stat_bonus",description:"+2 Geschwindigkeit",enlightened:!1,statBonus:{stat:"speed",amount:2}},{id:"dieb_stehlen",name:"Stehlen+2",class:"Dieb",type:"dice_bonus",description:"+2 auf Stehlen",enlightened:!1},{id:"dieb_fliehen",name:"Fliehen+2",class:"Dieb",type:"dice_bonus",description:"+2 auf Fliehen",enlightened:!1},{id:"dieb_schloesser_knacken",name:"Schl\xF6sser knacken+2",class:"Dieb",type:"dice_bonus",description:"+2 auf Schl\xF6sser knacken",enlightened:!1},{id:"dieb_feinmotoriker",name:"Feinmotoriker",class:"Dieb",type:"dice_bonus",description:"+1 auf Angriffe mit leichten Waffen",enlightened:!0},{id:"dieb_leichtfuessigkeit",name:"Leichtf\xFC\xDFigkeit",class:"Dieb",type:"passive",description:"Bewegung+2 bei weniger als 5 R\xFCstungsmalus",enlightened:!0},{id:"dieb_auge_der_gier",name:"Auge der Gier",class:"Dieb",type:"dice_bonus",description:"+2 auf Wert absch\xE4tzen",enlightened:!0},{id:"dieb_schleichen",name:"Schleichen",class:"Dieb",type:"active",description:"Bewegung, die von Gegnern schwer entdeckt werden kann, 10 pro Runde",enlightened:!0,cost:{type:"energy",amount:10,perRound:!0}},{id:"schuetze_geschick_2",name:"Geschicklichkeit+2",class:"Sch\xFCtze",type:"stat_bonus",description:"+2 Geschicklichkeit",enlightened:!1,statBonus:{stat:"dexterity",amount:2}},{id:"schuetze_reichweite",name:"Reichweite+10m",class:"Sch\xFCtze",type:"passive",description:"+10m Reichweite f\xFCr Fernkampfwaffen",enlightened:!1},{id:"schuetze_waffenwissen",name:"Waffenwissen",class:"Sch\xFCtze",type:"passive",description:"Waffenvorraussetzung-4 f\xFCr Fernkampfwaffen",enlightened:!0},{id:"schuetze_adlerauge",name:"Adlerauge",class:"Sch\xFCtze",type:"dice_bonus",description:"+1 im Fernkampf",enlightened:!1},{id:"schuetze_geschaerfte_sinne",name:"Gesch\xE4rfte Sinne",class:"Sch\xFCtze",type:"dice_bonus",description:"+2 auf alle Aktionen au\xDFerhalb von K\xE4mpfen, die gute Sehkraft vorraussetzen",enlightened:!0},{id:"schuetze_aetherfeuer",name:"\xC4therfeuer",class:"Sch\xFCtze",type:"active",description:"F\xFChre eine weitere Aktion aus. Bonusaktion",enlightened:!1,cost:{type:"mana",amount:20},bonusAction:!0},{id:"schuetze_zielschuss",name:"Zielschuss",class:"Sch\xFCtze",type:"active",description:"Schuss mit doppelter Reichweite und Schaden",enlightened:!1,cost:{type:"energy",amount:25}},{id:"ritter_leben_20",name:"Leben+20",class:"Ritter",type:"stat_bonus",description:"+20 Leben",enlightened:!1,statBonus:{stat:"life",amount:20}},{id:"ritter_reiten",name:"Reiten+2",class:"Ritter",type:"dice_bonus",description:"+2 auf Reiten",enlightened:!1},{id:"ritter_parieren",name:"Parieren+1",class:"Ritter",type:"dice_bonus",description:"+1 auf Parieren",enlightened:!1},{id:"ritter_ruestungsnegation",name:"R\xFCstungsnegation+5",class:"Ritter",type:"passive",description:"+5 R\xFCstungsnegation",enlightened:!1},{id:"ritter_tierfreund",name:"Tierfreund",class:"Ritter",type:"dice_bonus",description:"+2 im Umgang mit Tieren",enlightened:!0},{id:"ritter_ritterschwur",name:"Ritterschwur",class:"Ritter",type:"dice_bonus",description:"+2 auf Reaktionen, die gegnerische Angriffe auf Verb\xFCndete blocken",enlightened:!0},{id:"ritter_schwere_ruestung",name:"Schwere R\xFCstung",class:"Ritter",type:"active",description:"Negiert Schaden und wandelt ihn zu doppeltem R\xFCstungsschaden um",enlightened:!1,cost:{type:"energy",amount:10,perRound:!0}},{id:"ritter_schildstoss",name:"Schildsto\xDF",class:"Ritter",type:"active",description:"Angriff mit Schild, hoher R\xFCcksto\xDF",enlightened:!0,cost:{type:"energy",amount:10}},{id:"ritter_reitstoss",name:"Reitsto\xDF",class:"Ritter",type:"active",description:"Durchbohrender Angriff auf dem Pferd, +5 auf Zerst\xF6rung einer br\xFCchigen Waffe",enlightened:!1,cost:{type:"energy",amount:20}},{id:"moench_konstitution_3",name:"Konstitution+3",class:"M\xF6nch",type:"stat_bonus",description:"+3 Konstitution",enlightened:!1,statBonus:{stat:"constitution",amount:3}},{id:"moench_goettlicher_segen",name:"G\xF6ttlicher Segen",class:"M\xF6nch",type:"passive",description:"Pechresistenz",enlightened:!1},{id:"moench_fokussierte_schlaege",name:"Fokussierte Schl\xE4ge",class:"M\xF6nch",type:"dice_bonus",description:"+3 bei Angriffen auf Gegenst\xE4nde",enlightened:!1},{id:"moench_waffenloser_kampf",name:"Waffenloser Kampf",class:"M\xF6nch",type:"dice_bonus",description:"+2 im Kampf ohne Waffen (au\xDFer Handschuhe)",enlightened:!1},{id:"moench_hartes_training",name:"Hartes Training",class:"M\xF6nch",type:"passive",description:"Geschicklichkeit+4 bei weniger als 5 R\xFCstungsmalus",enlightened:!0},{id:"moench_chakra_blockade",name:"Chakra-Blockade",class:"M\xF6nch",type:"active",description:"Angriff, der gegnerische Extremit\xE4ten l\xE4hmt",enlightened:!1,cost:{type:"energy",amount:20}},{id:"moench_meditation",name:"Meditation",class:"M\xF6nch",type:"active",description:"Stellt pro Zug 5 Mana her",enlightened:!0,cost:{type:"energy",amount:0}},{id:"berserker_staerke_2",name:"St\xE4rke+2",class:"Berserker",type:"stat_bonus",description:"+2 St\xE4rke",enlightened:!1,statBonus:{stat:"strength",amount:2}},{id:"berserker_notfallstaerke",name:"Notfallst\xE4rke",class:"Berserker",type:"dice_bonus",description:"+1 im Kampf je 40 fehlende Leben, maximal +5",enlightened:!0},{id:"berserker_kriegsschrei",name:"Kriegsschrei",class:"Berserker",type:"passive",description:'Mit jedem get\xF6ten Gegner wird "Kampfschrei" ausgel\xF6st',enlightened:!1},{id:"berserker_unsterblicher_krieger",name:"Unsterblicher Krieger",class:"Berserker",type:"passive",description:"Heilt Leben um 3 D20, wenn Gegner get\xF6tet wird",enlightened:!1},{id:"berserker_adrenalin",name:"Adrenalin",class:"Berserker",type:"passive",description:"Immun gegen negative Statuseffekte im Ragemodus",enlightened:!1},{id:"berserker_rage",name:"Rage",class:"Berserker",type:"active",description:"Wird in den Ragemodus versetzt. Bonusaktion",enlightened:!1,cost:{type:"energy",amount:5},bonusAction:!0},{id:"berserker_wuetender_wurf",name:"W\xFCtender Wurf",class:"Berserker",type:"active",description:"Wirft einen Gegner bis zu 50m weit",enlightened:!0,cost:{type:"energy",amount:30}},{id:"berserker_erbarmungslosigkeit",name:"Erbarmunglosigkeit",class:"Berserker",type:"passive",description:"F\xFCr Z\xFCge in denen angegriffen wurde bleibt Rage bestehen",enlightened:!0},{id:"pluenderer_charisma_2",name:"Charisma+2",class:"Pl\xFCnderer",type:"stat_bonus",description:"+2 Charisma",enlightened:!1,statBonus:{stat:"chill",amount:2}},{id:"pluenderer_horter",name:"Horter",class:"Pl\xFCnderer",type:"passive",description:"Erh\xF6ht Inventarkapazit\xE4t um 50%",enlightened:!0},{id:"pluenderer_reichtum",name:"Reichtum",class:"Pl\xFCnderer",type:"passive",description:"Erh\xE4lt 50% mehr Geld durch Loot und Verk\xE4ufe",enlightened:!1},{id:"pluenderer_brandstifter",name:"Brandstifter",class:"Pl\xFCnderer",type:"passive",description:"Reduziert Schaden von normalem Feuer um 80%",enlightened:!0},{id:"pluenderer_raeuerbande",name:"R\xE4uberbande",class:"Pl\xFCnderer",type:"dice_bonus",description:"+1 im Kampf, wenn deine Gruppe in \xDCberzahl ist",enlightened:!0},{id:"pluenderer_pluendern",name:"Pl\xFCndern",class:"Pl\xFCnderer",type:"active",description:"Schlag, der dem Gegner Geld stiehlt (D20)",enlightened:!1,cost:{type:"energy",amount:10}},{id:"jaeger_geschick_3",name:"Geschicklichkeit+3",class:"J\xE4ger",type:"stat_bonus",description:"+3 Geschicklichkeit",enlightened:!1,statBonus:{stat:"dexterity",amount:3}},{id:"jaeger_klettern",name:"Klettern+2",class:"J\xE4ger",type:"dice_bonus",description:"+2 auf Klettern",enlightened:!1},{id:"jaeger_verstecken",name:"Verstecken+2",class:"J\xE4ger",type:"dice_bonus",description:"+2 auf Verstecken",enlightened:!1},{id:"jaeger_fallen_stellen",name:"Fallen stellen+2",class:"J\xE4ger",type:"dice_bonus",description:"+2 auf Fallen stellen",enlightened:!1},{id:"jaeger_dynamisches_schiessen",name:"Dynamisches Schie\xDFen",class:"J\xE4ger",type:"passive",description:"Kann w\xE4hrend dem Laufen ohne Malus schie\xDFen",enlightened:!1},{id:"jaeger_basteln",name:"Basteln",class:"J\xE4ger",type:"passive",description:"Die Qualit\xE4t hergestellter Munition erh\xF6ht sich um einen Rang",enlightened:!0},{id:"jaeger_spuren_lesen",name:"Spuren lesen",class:"J\xE4ger",type:"passive",description:"Kann Spuren von Tieren und Gegnern lesen und verfolgen",enlightened:!0},{id:"jaeger_angedrehte_schuesse",name:"Angedrehte Sch\xFCsse",class:"J\xE4ger",type:"passive",description:"Fernkampfprojektile k\xF6nnen in der Luft die Richtung \xE4ndern",enlightened:!1},{id:"erzritter_konstitution_4",name:"Konstitution+4",class:"Erzritter",type:"stat_bonus",description:"+4 Konstitution",enlightened:!1,statBonus:{stat:"constitution",amount:4}},{id:"erzritter_waffenkenner",name:"Waffenkenner",class:"Erzritter",type:"passive",description:"Waffenvorraussetzung-8 f\xFCr schwere Waffen",enlightened:!0},{id:"erzritter_rittmeister",name:"Rittmeister",class:"Erzritter",type:"dice_bonus",description:"+2 auf Angriffe wenn auf einem Reittier",enlightened:!1},{id:"erzritter_unzerbrechliche_ruestung",name:"Unzerbrechliche R\xFCstung",class:"Erzritter",type:"passive",description:"Halbiert R\xFCstungsschaden",enlightened:!1},{id:"erzritter_volle_wucht",name:"Volle Wucht",class:"Erzritter",type:"active",description:"Rammangriff, der mit R\xFCstungsgewicht skaliert",enlightened:!0,cost:{type:"energy",amount:15}},{id:"erzritter_schwerer_panzer",name:"Schwerer Panzer",class:"Erzritter",type:"passive",description:'"Schwere R\xFCstung" ist dauerhaft aktiv und kostet keine Ausdauer. Kann deaktiviert werden.',enlightened:!1,requiresSkill:"ritter_schwere_ruestung"},{id:"erzritter_ruestungsschmied",name:"R\xFCstungsschmied",class:"Erzritter",type:"passive",description:"Verdreifacht erw\xFCrfelte Schmiedepunkte beim Schmieden von R\xFCstung",enlightened:!1},{id:"erzritter_magische_ausruestung",name:"Magische Ausr\xFCstung",class:"Erzritter",type:"active",description:"R\xFCstung wird magisch an- und ausger\xFCstet",enlightened:!1,cost:{type:"mana",amount:5}},{id:"templer_tempo_4",name:"Geschwindigkeit+4",class:"Templer",type:"stat_bonus",description:"+4 Geschwindigkeit",enlightened:!1,statBonus:{stat:"speed",amount:4}},{id:"templer_verlaengerter_arm",name:"Verl\xE4ngerter Arm",class:"Templer",type:"passive",description:'St\xE4be z\xE4hlen f\xFCr "Waffenloser Kampf"',enlightened:!1,requiresSkill:"moench_waffenloser_kampf"},{id:"templer_chakrawissen",name:"Chakrawissen",class:"Templer",type:"passive",description:'"Chakra-Blockade" kann f\xFCr jeden Angriff ohne Kosten aktiviert werden',enlightened:!1,requiresSkill:"moench_chakra_blockade"},{id:"templer_staehlerne_haut",name:"St\xE4hlerne Haut",class:"Templer",type:"passive",description:"Halbiert Schaden gegen Wuchtangriffe",enlightened:!0},{id:"templer_mentale_ruestung",name:"Mentale R\xFCstung",class:"Templer",type:"passive",description:"Kann bei Schaden anstatt Leben 150% des Schadens als Ausdauer verlieren",enlightened:!0},{id:"templer_laehmung",name:"L\xE4hmung",class:"Templer",type:"active",description:"Angriff, der Gegner komplett l\xE4hmt",enlightened:!1,cost:{type:"energy",amount:30}},{id:"templer_absolute_kontrolle",name:"Absolute Kontrolle",class:"Templer",type:"active",description:"Kann jeden Gegner in Reichweite mit Nahkampfwaffe einmal pro Runde angreifen, -1 je Angriff nach dem Ersten",enlightened:!0,cost:{type:"energy",amount:0}},{id:"templer_kraft_aus_inneren",name:"Kraft aus dem Inneren",class:"Templer",type:"active",description:"Nach Kanalisierung 10 HP Heilung pro Zug und Bewegung+5, Buffdauer entspricht Kanalisierungsdauer",enlightened:!0,cost:{type:"energy",amount:10}},{id:"klingentaenzer_tempo_4",name:"Geschwindigkeit+4",class:"Klingent\xE4nzer",type:"stat_bonus",description:"+4 Geschwindigkeit",enlightened:!1,statBonus:{stat:"speed",amount:4}},{id:"klingentaenzer_waffen_werfen",name:"Waffen werfen+2",class:"Klingent\xE4nzer",type:"dice_bonus",description:"+2 auf Waffen werfen",enlightened:!1},{id:"klingentaenzer_waffengelehrter",name:"Waffengelehrter",class:"Klingent\xE4nzer",type:"passive",description:"Waffenvorraussetzung-8 f\xFCr leichte Waffen",enlightened:!0},{id:"klingentaenzer_waffentanz",name:"Waffentanz",class:"Klingent\xE4nzer",type:"passive",description:"+1 auf den ersten Angriff mit einer Waffe. Erneuert sich, wenn Waffe min. 1m von dir entfernt ist oder in dieser Runde aufgehoben wurde",enlightened:!1},{id:"klingentaenzer_akrobat",name:"Akrobat",class:"Klingent\xE4nzer",type:"passive",description:"+3 Bewegung auf Waffen zu, die momentan niemand h\xE4lt",enlightened:!1},{id:"klingentaenzer_unantastbar",name:"Unantastbar",class:"Klingent\xE4nzer",type:"passive",description:"Nach einer Killbeteiligung kann in der n\xE4chsten Runde einem Angriff ausgewichen werden",enlightened:!0},{id:"klingentaenzer_fliegender_kick",name:"Fliegender Kick",class:"Klingent\xE4nzer",type:"active",description:"Leichte Waffen, die sich in der Luft befinden, k\xF6nnen auf Gegner gekickt werden. Kann auch als Reaktion genutzt werden",enlightened:!1,cost:{type:"energy",amount:10}},{id:"klingentaenzer_klingenwirbel",name:"Klingenwirbel",class:"Klingent\xE4nzer",type:"active",description:"Wirf eine leichte Waffe mit so viel Drall, dass sie n\xE4chste Runde zur\xFCckkehrt, 5 pro Runde",enlightened:!0,cost:{type:"energy",amount:5,perRound:!0}},{id:"assassine_ausdauer_40",name:"Ausdauer+40",class:"Assassine",type:"stat_bonus",description:"+40 Ausdauer",enlightened:!1,statBonus:{stat:"energy",amount:40}},{id:"assassine_gnadenstoss",name:"Gnadensto\xDF",class:"Assassine",type:"dice_bonus",description:"+2 auf Angriffe gegen vergiftete Gegner",enlightened:!0},{id:"assassine_exitus",name:"Exitus",class:"Assassine",type:"dice_bonus",description:"+1 auf Angriffe mit Absicht zu t\xF6ten",enlightened:!1},{id:"assassine_hinterhalt",name:"Hinterhalt",class:"Assassine",type:"dice_bonus",description:"+2, wenn Gegner von hinten angegriffen wird",enlightened:!1},{id:"assassine_infiltration",name:"Infiltration",class:"Assassine",type:"passive",description:"Bewegung+3, wenn deine Gruppe in Unterzahl ist",enlightened:!0},{id:"assassine_gift_mischen",name:"Gift mischen",class:"Assassine",type:"dice_bonus",description:"+2 beim Brauen auf Tr\xE4nke mit sch\xE4dlichem Effekt",enlightened:!0},{id:"assassine_phantomschnitt",name:"Phantomschnitt",class:"Assassine",type:"active",description:"Greift Gegner an, der erst nach bis zu einer Minute Schaden nimmt",enlightened:!1,cost:{type:"energy",amount:30}},{id:"koloss_konstitution_staerke_2",name:"Konstitution & St\xE4rke+2\u221E",class:"Koloss",type:"passive",description:"+2 Konstitution & +2 St\xE4rke (kann mehrfach gew\xE4hlt werden)",enlightened:!1,infiniteLevel:!0},{id:"koloss_weg_des_eroberers",name:"Weg des Eroberers",class:"Koloss",type:"passive",description:"Kann nicht von gegnerischen Angriffen bewegt werden",enlightened:!0},{id:"koloss_unaufhaltsam",name:"Unaufhaltsam",class:"Koloss",type:"passive",description:"Reduziert Schaden aus allen Quellen um 10",enlightened:!0},{id:"koloss_provokante_praesenz",name:"Provokante Pr\xE4senz",class:"Koloss",type:"passive",description:"Zieht Fokus der Gegner auf sich",enlightened:!0},{id:"koloss_erdbeben",name:"Erdbeben",class:"Koloss",type:"active",description:"Erzeugt Beben im Umkreis, Kosten entsprechen der H\xE4lfte des Radius",enlightened:!1,cost:{type:"energy",amount:0}},{id:"koloss_wahre_groesse",name:"Wahre Gr\xF6\xDFe",class:"Koloss",type:"active",description:"Wird f\xFCr kurze Zeit viel gr\xF6\xDFer, Kosten entsprechen Gr\xF6\xDFenskalierung*10 pro Runde",enlightened:!1,cost:{type:"energy",amount:0,perRound:!0}},{id:"koloss_kolossaler_schlag",name:"Kolossaler Schlag",class:"Koloss",type:"active",description:"Holt f\xFCr Schlag aus, der mehr Reichweite und Schaden besitzt, je l\xE4nger ausgeholt wird",enlightened:!0,cost:{type:"energy",amount:20}},{id:"waffenmeister_geschick_staerke_2",name:"Geschicklichkeit & St\xE4rke+2\u221E",class:"Waffenmeister",type:"passive",description:"+2 Geschicklichkeit & +2 St\xE4rke (kann mehrfach gew\xE4hlt werden)",enlightened:!1,infiniteLevel:!0},{id:"waffenmeister_waffenmeister",name:"Waffenmeister",class:"Waffenmeister",type:"passive",description:'Waffenvorraussetzungen werden aufgehoben, ben\xF6tigt "Waffenwissen", "Waffenkenner" und "Waffengelehrter"',enlightened:!0,requiresSkill:["schuetze_waffenwissen","erzritter_waffenkenner","klingentaenzer_waffengelehrter"]},{id:"waffenmeister_wandelndes_arsenal",name:"Wandelndes Arsenal",class:"Waffenmeister",type:"dice_bonus",description:"+2 auf jeden Angriff nach Waffenwechsel",enlightened:!0},{id:"waffenmeister_waffenschmied",name:"Waffenschmied",class:"Waffenmeister",type:"passive",description:"Verdreifacht erw\xFCrfelte Schmiedepunkte beim Schmieden von Waffen",enlightened:!1},{id:"waffenmeister_ultimativer_stoss",name:"Ultimativer Sto\xDF",class:"Waffenmeister",type:"active",description:"Getroffener Gegner wird zur\xFCckgeworfen, maximal 200m, nur f\xFCr Wuchtwaffen",enlightened:!1,cost:{type:"energy",amount:30}},{id:"waffenmeister_sturmschnitt",name:"Sturmschnitt",class:"Waffenmeister",type:"active",description:"Erzeugt Schockwelle, die getroffenen Gegnern Schnittwunden zuf\xFCgt, maximal 50m, nur f\xFCr Schnittwaffen",enlightened:!1,cost:{type:"energy",amount:30}},{id:"waffenmeister_panzerbrecher",name:"Panzerbrecher",class:"Waffenmeister",type:"active",description:"Stich, der gegnerische Verteidigung durchbricht, nur f\xFCr Stichwaffen",enlightened:!1,cost:{type:"energy",amount:30}},{id:"duellant_geschick_4",name:"Geschicklichkeit+4\u221E",class:"Duellant",type:"passive",description:"+4 Geschicklichkeit (kann mehrfach gew\xE4hlt werden)",enlightened:!1,infiniteLevel:!0},{id:"duellant_duell",name:"Duell",class:"Duellant",type:"dice_bonus",description:"+2 in einem Duell",enlightened:!1},{id:"duellant_perfektion",name:"Perfektion",class:"Duellant",type:"dice_bonus",description:"Wenn Leben voll, +2 im Kampf",enlightened:!1},{id:"duellant_furie",name:"Furie",class:"Duellant",type:"dice_bonus",description:"+1 auf diesen Gegner mit jedem kontinuierlichen Treffer, maximal +5",enlightened:!0},{id:"duellant_uebertakten",name:"\xDCbertakten",class:"Duellant",type:"active",description:"Greift Gegner an, kann nach einem Treffer eine weitere Aktion ausf\xFChren, 15 (x2 mit jeder weiteren Benutzung in dieser Runde)",enlightened:!0,cost:{type:"energy",amount:15}},{id:"duellant_konter",name:"Konter",class:"Duellant",type:"active",description:"Blockt und reflektiert physischen Angriff mit doppelter St\xE4rke. Reaktion",enlightened:!1,cost:{type:"energy",amount:20}},{id:"duellant_schwachstellen_aufdecken",name:"Schwachstellen aufdecken",class:"Duellant",type:"active",description:"Kann R\xFCstung mit n\xE4chstem Angriff ignorieren. Bonusaktion",enlightened:!0,cost:{type:"energy",amount:15},bonusAction:!0},{id:"attentaeter_geschick_tempo_2",name:"Geschicklichkeit & Geschwindigkeit+2\u221E",class:"Attent\xE4ter",type:"passive",description:"+2 Geschicklichkeit & +2 Geschwindigkeit (kann mehrfach gew\xE4hlt werden)",enlightened:!1,infiniteLevel:!0},{id:"attentaeter_reichweite_50",name:"Reichweite+50m",class:"Attent\xE4ter",type:"passive",description:"+50m Reichweite f\xFCr Fernkampfwaffen",enlightened:!1},{id:"attentaeter_schattenlaeufer",name:"Schattenl\xE4ufer",class:"Attent\xE4ter",type:"passive",description:'Kann "Schleichen" ohne Ausdauerkosten benutzen',enlightened:!0,requiresSkill:"dieb_schleichen"},{id:"attentaeter_federfall",name:"Federfall",class:"Attent\xE4ter",type:"passive",description:"Fallschaden um 90% reduziert",enlightened:!0},{id:"attentaeter_erfrischender_mord",name:"Erfrischender Mord",class:"Attent\xE4ter",type:"passive",description:"Stellt 3 D20 Ausdauer her, wenn Gegner get\xF6tet wird",enlightened:!1},{id:"attentaeter_ueberwachung",name:"\xDCberwachung",class:"Attent\xE4ter",type:"active",description:"Kann bei K\xF6rperkontakt andere Person markieren. Der Anwender kann die Markierung orten, solange sie aktiv ist. Die Markierung kann leicht zerst\xF6rt werden",enlightened:!1,cost:{type:"energy",amount:5,perRound:!0}},{id:"attentaeter_blitzschritt",name:"Blitzschritt",class:"Attent\xE4ter",type:"active",description:"Verdoppelt Bewegung. Bonusaktion, 45 pro Runde",enlightened:!1,cost:{type:"energy",amount:45,perRound:!0},bonusAction:!0},{id:"attentaeter_tragisches_schicksal",name:"Tragisches Schicksal",class:"Attent\xE4ter",type:"active",description:"Markiere vor dem Kampf einen Gegner in Sichtweite. +5 auf ersten Angriff gegen ihn als einzelnes Ziel",enlightened:!1,cost:{type:"energy",amount:50}},{id:"schnellschuetze_movement",name:"+ Movement",class:"Schnellsch\xFCtze",type:"stat_bonus",description:"+2 Geschwindigkeit",enlightened:!1,statBonus:{stat:"speed",amount:2}},{id:"schnellschuetze_instant_reload",name:"Instant reload",class:"Schnellsch\xFCtze",type:"passive",description:"Sofortiges Nachladen",enlightened:!1},{id:"schnellschuetze_multishot",name:"Multishot",class:"Schnellsch\xFCtze",type:"active",description:"Mehrfachschuss",enlightened:!1,cost:{type:"energy",amount:15}},{id:"schnellschuetze_follow_up_attack",name:"Follow up attack",class:"Schnellsch\xFCtze",type:"passive",description:"Kann immer angreifen, wenn ein Gegner handlungsunf\xE4hig wird (Reaktion)",enlightened:!1},{id:"schnellschuetze_runde_2",name:"Runde 2",class:"Schnellsch\xFCtze",type:"passive",description:"Erh\xE4lt eine weitere Aktion pro Runde, wenn er diese Runde einen Gegner t\xF6tet",enlightened:!1},{id:"schnellschuetze_unberuehrt",name:"Unber\xFChrt",class:"Schnellsch\xFCtze",type:"passive",description:"25% Movement, wenn er diese und letzte Runde keinen Schaden genommen hat",enlightened:!1},{id:"kampfakrobat_sprungdistanz",name:"+ Sprungdistanz",class:"Kampfakrobat",type:"dice_bonus",description:"+2 auf Sprungdistanz",enlightened:!1},{id:"kampfakrobat_bonusaktion",name:"+ 1 Bonusaktion",class:"Kampfakrobat",type:"passive",description:"+1 Bonusaktion pro Runde",enlightened:!1},{id:"kampfakrobat_sprungangriff",name:"Sprungangriff",class:"Kampfakrobat",type:"dice_bonus",description:"+2 auf Angriffe in der Luft",enlightened:!1},{id:"kampfakrobat_sicherer_fall",name:"Sicherer Fall",class:"Kampfakrobat",type:"active",description:"Landet auf unsicherem Boden und erh\xE4lt +1 auf n\xE4chsten Angriff. Bonusaktion",enlightened:!1,cost:{type:"energy",amount:5},bonusAction:!0},{id:"kampfakrobat_opportunist",name:"Opportunist",class:"Kampfakrobat",type:"passive",description:"Wenn du einem Angriff ausweichst, kontere mit einem simplen Waffenangriff (Reaktion)",enlightened:!1},{id:"kampfakrobat_bonusangriff",name:"Bonusangriff",class:"Kampfakrobat",type:"active",description:"Angriff als Bonusaktion",enlightened:!1,cost:{type:"energy",amount:10},bonusAction:!0},{id:"general_charisma",name:"+ Chill",class:"General",type:"stat_bonus",description:"+2 Charisma",enlightened:!1,statBonus:{stat:"chill",amount:2}},{id:"general_meisterstratege",name:"Meisterstratege",class:"General",type:"passive",description:"Kann die Strategie des Gegners mit Blick auf das Schlachtfeld erkennen",enlightened:!1},{id:"general_angriffsbefehl",name:"Angriffsbefehl",class:"General",type:"active",description:"Schenkt einem Verb\xFCndeten einen Extrazug (Aktion)",enlightened:!1,cost:{type:"energy",amount:30}},{id:"general_schutzbefehl",name:"Schutzbefehl",class:"General",type:"active",description:"Ein Veb\xFCndeter erh\xE4lt +5 auf die Reaktion des n\xE4chsten Angriffs (Aktion)",enlightened:!1,cost:{type:"energy",amount:20}},{id:"general_standbefehl",name:"Standbefehl",class:"General",type:"active",description:"Zieht eine Linie, auf der alle Verb\xFCndeten im Kampf +1 erhalten (Aktion)",enlightened:!1,cost:{type:"energy",amount:25}},{id:"general_leibwaechter",name:"Leibw\xE4chter",class:"General",type:"dice_bonus",description:"+2 auf Reaktionen von Verb\xFCndeten, um dich zu sch\xFCtzen",enlightened:!1},{id:"general_befehlskette",name:"Befehlskette",class:"General",type:"active",description:"Kann diese Runde unendlich viele Befehle ausgeben f\xFCr doppelte Ausdauerkosten (Bonus)",enlightened:!1,cost:{type:"energy",amount:0},bonusAction:!0},{id:"kriegsherr_staerke",name:"+ St\xE4rke",class:"Kriegsherr",type:"stat_bonus",description:"+2 St\xE4rke",enlightened:!1,statBonus:{stat:"strength",amount:2}},{id:"kriegsherr_blutrausch",name:"Blutrausch",class:"Kriegsherr",type:"passive",description:"Bei Kill weitere Aktion",enlightened:!1},{id:"kriegsherr_lebensmuede",name:"Lebensm\xFCde",class:"Kriegsherr",type:"active",description:"+3 auf Nahkampfangriffe, -2 gegen Angriffe (Bonus)",enlightened:!1,cost:{type:"energy",amount:10},bonusAction:!0},{id:"kriegsherr_todeswirbel",name:"Todeswirbel",class:"Kriegsherr",type:"active",description:"360\xB0 Schwung, st\xE4rker mit jedem getroffenen Gegner (Aktion)",enlightened:!1,cost:{type:"energy",amount:30}},{id:"kriegsherr_wutbewaeltigung",name:"Wutbew\xE4ltigung",class:"Kriegsherr",type:"passive",description:"Negative Effekte von Rage werden aufgehoben",enlightened:!1},{id:"kriegsherr_leben_opfern",name:"Leben opfern",class:"Kriegsherr",type:"active",description:"Setzt Leben auf 1, erh\xE4lt eine Aktion pro 30 geopferten Leben (Aktion)",enlightened:!1,cost:{type:"life",amount:0}},{id:"kriegsherr_maechtiger_stoss",name:"M\xE4chtiger Sto\xDF",class:"Kriegsherr",type:"passive",description:"Gegner, die von Nahkampfangriffen getroffen werden, fliegen bis zu 20m weg. Kann deaktiviert werden",enlightened:!1},{id:"kriegsherr_vorreiter",name:"Vorreiter",class:"Kriegsherr",type:"passive",description:"Wenn du den ersten Treffer austeilst oder einsteckst, erhalten alle Verb\xFCndeten eine! Aktion f\xFCr ihren n\xE4chsten Zug",enlightened:!1},{id:"waechter_konstitution",name:"+ Konstitution",class:"W\xE4chter",type:"stat_bonus",description:"+2 Konstitution",enlightened:!1,statBonus:{stat:"constitution",amount:2}},{id:"waechter_leibwache",name:"Leibwache",class:"W\xE4chter",type:"passive",description:"Erh\xE4lt 2 Reaktionen f\xFCr Angriffe auf Verb\xFCndete in der N\xE4he",enlightened:!1},{id:"waechter_beschuetzerinstinkt",name:"Besch\xFCtzerinstinkt",class:"W\xE4chter",type:"active",description:"Sp\xFCrt alle Gefahren in der Umgebung auf, Kosten skalieren mit Reichweite (Aktion)",enlightened:!1,cost:{type:"energy",amount:0}},{id:"waechter_kenne_deinen_feind",name:"Kenne deinen Feind",class:"W\xE4chter",type:"passive",description:"Nach jedem erfolgreichen Block erh\xE4lst du +1 auf alle Angriffe und Blocks gegen diesen Gegner, maximal +3",enlightened:!1},{id:"waechter_vergeltungsschlag",name:"Vergeltungsschlag",class:"W\xE4chter",type:"active",description:"Geht in eine defensive Position f\xFCr die Dauer des Skills, was Bewegung halbiert und nur defensive Aktionen erlaubt. Wird der Skill beendet, wird ein Schlag ausgef\xFChrt, dessen St\xE4rke mit dem eingesteckten Schaden skaliert (Aktion)",enlightened:!1,cost:{type:"energy",amount:20}},{id:"waechter_schildmeister",name:"Schildmeister",class:"W\xE4chter",type:"dice_bonus",description:"+2 auf Angriffe und Blocks mit Schild",enlightened:!1},{id:"waechter_edles_opfer",name:"Edles Opfer",class:"W\xE4chter",type:"passive",description:"Wenn du kampfunf\xE4hig wirst, erhalten alle Verb\xFCndeten in der N\xE4he einmal pro Kampf eine Heilung, die der H\xE4lfte deiner Leben entspricht",enlightened:!1},{id:"omen_hp",name:"+ HP",class:"Omen",type:"stat_bonus",description:"+30 Leben",enlightened:!1,statBonus:{stat:"life",amount:30}},{id:"omen_bedroher",name:"Bedroher",class:"Omen",type:"passive",description:"Vorteil auf Bedrohung",enlightened:!1},{id:"omen_vorwarnung",name:"Vorwarnung",class:"Omen",type:"active",description:"Kann eine bereits bekannte Person verfluchen, nach einem Tag wird diese Person von Pech verfolgt. Dieser Effekt wird st\xE4rker, je n\xE4her der Nutzer zum verfluchten Ziel ist. Kostet 1/4 der gegn. HP (Aktion)",enlightened:!1,cost:{type:"energy",amount:0}},{id:"omen_kraftraub",name:"Kraftraub",class:"Omen",type:"active",description:"Stiehlt die Ausdauer einer anderen Person und regeneriert den selben Betrag beim Nutzer (Aktion)",enlightened:!1,cost:{type:"energy",amount:20}},{id:"omen_schlachtschwur",name:"Schlachtschwur",class:"Omen",type:"active",description:"Solange die F\xE4higkeit aktiv ist, wird der Schaden gegen den Anwender gespeichert. Wenn er einen Gegner t\xF6tet, wird der gespeicherte Schaden wieder geheilt (Aktion)",enlightened:!1,cost:{type:"energy",amount:15,perRound:!0}},{id:"omen_unheilvoller_auftritt",name:"Unheilvoller Auftritt",class:"Omen",type:"active",description:"Bereitet f\xFCr 3 Runden ein finsteres Ritual an einem Ort in seinem Sichtfeld vor, w\xE4hrend denen der Nutzer nichts anderes tun kann. Danach h\xFCllt er diesen Ort in Finsternis und fliegt in sein Zentrum. Alle Gegner im Umkreis werden entweder gel\xE4hmt, ver\xE4ngstigt, oder verstummt (Aktion)",enlightened:!1,cost:{type:"mana",amount:50}},{id:"omen_fluchruestung",name:"Fluchr\xFCstung",class:"Omen",type:"active",description:"Absorbiert alle negativen Effekte aller Personen im Umkreis. Erh\xE4lt R\xFCstung abh\xE4ngig von der Anzahl und St\xE4rke der absorbierten Effekte f\xFCr 3 Runden",enlightened:!1,cost:{type:"mana",amount:30}},{id:"omen_finstere_aura",name:"Finstere Aura",class:"Omen",type:"passive",description:"Gegner, die ihm Schaden zuf\xFCgen, werden mit geringer Wahrscheinlichkeit ver\xE4ngstigt",enlightened:!1}];function Lt(s){return fe.filter(t=>t.class===s)}var ge=class{static classes=new Map;static initialized=!1;static initialize(){if(this.initialized)return;this.classes.clear();let t=new Map;for(let[e,n]of Object.entries(Oe)){let i=this.normalize(e);this.classes.has(i)||this.classes.set(i,{name:e,parents:[]});for(let o of n.children){let _=this.normalize(o.className);t.has(_)||t.set(_,[]),t.get(_).push(i),this.classes.has(_)||this.classes.set(_,{name:o.className,parents:[]})}}for(let[e,n]of t.entries()){let i=this.classes.get(e);i&&(i.parents=n)}this.initialized=!0}static normalize(t){return t.split("@")[0].toLowerCase().trim()}static toDisplayName(t){return t.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}static isClassEnabled(t,e,n){if(this.initialized||this.initialize(),!t)return!0;let i=this.normalize(t),o=this.normalize(e||""),_=this.normalize(n||"");return i===o||i===_?!0:this.inheritsFrom(o,i)||this.inheritsFrom(_,i)}static inheritsFrom(t,e){if(!t||!e)return!1;if(t===e)return!0;let n=this.classes.get(t);if(!n?.parents||n.parents.length===0)return!1;for(let i of n.parents)if(i===e||this.inheritsFrom(i,e))return!0;return!1}static getValidClassesFor(t){let e=this.normalize(t),n=[e];for(let[i]of this.classes.entries())this.inheritsFrom(i,e)&&n.push(i);return n}static getDisplayName(t){let e=this.normalize(t);return this.classes.get(e)?.name||this.toDisplayName(e)}static getAllClasses(){return Array.from(this.classes.keys())}static isInitialized(){return this.initialized}};var Ee=class s{create=new k;cancel=new k;newItem={name:"",description:"",weight:0,lost:!1,requirements:{},statModifiers:[]};tempModifiers={strength:0,dexterity:0,speed:0,intelligence:0,constitution:0,chill:0,mana:0,life:0,energy:0};createItem(){if(!this.newItem.name.trim()){alert("Item name is required");return}let t=[];Object.entries(this.tempModifiers).forEach(([n,i])=>{i!==0&&t.push({stat:n,amount:i})});let e=Ce(be({},this.newItem),{statModifiers:t.length>0?t:void 0});this.create.emit(e),this.newItem={name:"",lost:!1,description:"",weight:0,requirements:{},statModifiers:[]},this.tempModifiers={strength:0,dexterity:0,speed:0,intelligence:0,constitution:0,chill:0,mana:0,life:0,energy:0}}cancelCreate(){this.cancel.emit()}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=I({type:s,selectors:[["app-item-creator"]],outputs:{create:"create",cancel:"cancel"},decls:86,vars:18,consts:[[1,"creator-form",3,"ngSubmit"],[1,"field"],["for","name"],["id","name","type","text","name","name","placeholder","Enter item name","required","",3,"ngModelChange","ngModel"],["for","weight"],["id","weight","type","number","step","0.1","min","0","name","weight","placeholder","0",3,"ngModelChange","ngModel"],["for","description"],["id","description","name","description","rows","4","placeholder","Describe the item...",3,"ngModelChange","ngModel"],[1,"requirements-section"],[1,"requirements-grid"],[1,"req-field"],["type","number","min","0","name","reqStrength","placeholder","-",3,"ngModelChange","ngModel"],["type","number","min","0","name","reqDexterity","placeholder","-",3,"ngModelChange","ngModel"],["type","number","min","0","name","reqSpeed","placeholder","-",3,"ngModelChange","ngModel"],["type","number","min","0","name","reqIntelligence","placeholder","-",3,"ngModelChange","ngModel"],["type","number","min","0","name","reqConstitution","placeholder","-",3,"ngModelChange","ngModel"],["type","number","min","0","name","reqChill","placeholder","-",3,"ngModelChange","ngModel"],["type","number","name","modStrength","placeholder","0",3,"ngModelChange","ngModel"],["type","number","name","modDexterity","placeholder","0",3,"ngModelChange","ngModel"],["type","number","name","modSpeed","placeholder","0",3,"ngModelChange","ngModel"],["type","number","name","modIntelligence","placeholder","0",3,"ngModelChange","ngModel"],["type","number","name","modConstitution","placeholder","0",3,"ngModelChange","ngModel"],["type","number","name","modChill","placeholder","0",3,"ngModelChange","ngModel"],["type","number","name","modMana","placeholder","0",3,"ngModelChange","ngModel"],["type","number","name","modLife","placeholder","0",3,"ngModelChange","ngModel"],["type","number","name","modEnergy","placeholder","0",3,"ngModelChange","ngModel"],[1,"button-group"],["type","submit",1,"create-btn"],["type","button",1,"cancel-btn",3,"click"]],template:function(e,n){e&1&&(r(0,"form",0),m("ngSubmit",function(){return n.createItem()}),r(1,"div",1)(2,"label",2),c(3,"Item Name *"),a(),r(4,"input",3),w("ngModelChange",function(o){return v(n.newItem.name,o)||(n.newItem.name=o),o}),a()(),r(5,"div",1)(6,"label",4),c(7,"Weight (kg)"),a(),r(8,"input",5),w("ngModelChange",function(o){return v(n.newItem.weight,o)||(n.newItem.weight=o),o}),a()(),r(9,"div",1)(10,"label",6),c(11,"Description"),a(),r(12,"textarea",7),w("ngModelChange",function(o){return v(n.newItem.description,o)||(n.newItem.description=o),o}),a()(),r(13,"div",8)(14,"label"),c(15,"Requirements"),a(),r(16,"div",9)(17,"div",10)(18,"label"),c(19,"STR"),a(),r(20,"input",11),w("ngModelChange",function(o){return v(n.newItem.requirements.strength,o)||(n.newItem.requirements.strength=o),o}),a()(),r(21,"div",10)(22,"label"),c(23,"DEX"),a(),r(24,"input",12),w("ngModelChange",function(o){return v(n.newItem.requirements.dexterity,o)||(n.newItem.requirements.dexterity=o),o}),a()(),r(25,"div",10)(26,"label"),c(27,"SPD"),a(),r(28,"input",13),w("ngModelChange",function(o){return v(n.newItem.requirements.speed,o)||(n.newItem.requirements.speed=o),o}),a()(),r(29,"div",10)(30,"label"),c(31,"INT"),a(),r(32,"input",14),w("ngModelChange",function(o){return v(n.newItem.requirements.intelligence,o)||(n.newItem.requirements.intelligence=o),o}),a()(),r(33,"div",10)(34,"label"),c(35,"CON"),a(),r(36,"input",15),w("ngModelChange",function(o){return v(n.newItem.requirements.constitution,o)||(n.newItem.requirements.constitution=o),o}),a()(),r(37,"div",10)(38,"label"),c(39,"CHL"),a(),r(40,"input",16),w("ngModelChange",function(o){return v(n.newItem.requirements.chill,o)||(n.newItem.requirements.chill=o),o}),a()()()(),r(41,"div",8)(42,"label"),c(43,"Stat Modifiers (Boni/Mali)"),a(),r(44,"div",9)(45,"div",10)(46,"label"),c(47,"STR"),a(),r(48,"input",17),w("ngModelChange",function(o){return v(n.tempModifiers.strength,o)||(n.tempModifiers.strength=o),o}),a()(),r(49,"div",10)(50,"label"),c(51,"DEX"),a(),r(52,"input",18),w("ngModelChange",function(o){return v(n.tempModifiers.dexterity,o)||(n.tempModifiers.dexterity=o),o}),a()(),r(53,"div",10)(54,"label"),c(55,"SPD"),a(),r(56,"input",19),w("ngModelChange",function(o){return v(n.tempModifiers.speed,o)||(n.tempModifiers.speed=o),o}),a()(),r(57,"div",10)(58,"label"),c(59,"INT"),a(),r(60,"input",20),w("ngModelChange",function(o){return v(n.tempModifiers.intelligence,o)||(n.tempModifiers.intelligence=o),o}),a()(),r(61,"div",10)(62,"label"),c(63,"CON"),a(),r(64,"input",21),w("ngModelChange",function(o){return v(n.tempModifiers.constitution,o)||(n.tempModifiers.constitution=o),o}),a()(),r(65,"div",10)(66,"label"),c(67,"CHL"),a(),r(68,"input",22),w("ngModelChange",function(o){return v(n.tempModifiers.chill,o)||(n.tempModifiers.chill=o),o}),a()(),r(69,"div",10)(70,"label"),c(71,"MANA"),a(),r(72,"input",23),w("ngModelChange",function(o){return v(n.tempModifiers.mana,o)||(n.tempModifiers.mana=o),o}),a()(),r(73,"div",10)(74,"label"),c(75,"LEBEN"),a(),r(76,"input",24),w("ngModelChange",function(o){return v(n.tempModifiers.life,o)||(n.tempModifiers.life=o),o}),a()(),r(77,"div",10)(78,"label"),c(79,"AUSD"),a(),r(80,"input",25),w("ngModelChange",function(o){return v(n.tempModifiers.energy,o)||(n.tempModifiers.energy=o),o}),a()()()(),r(81,"div",26)(82,"button",27),c(83,"Create"),a(),r(84,"button",28),m("click",function(){return n.cancelCreate()}),c(85,"Cancel"),a()()()),e&2&&(l(4),x("ngModel",n.newItem.name),l(4),x("ngModel",n.newItem.weight),l(4),x("ngModel",n.newItem.description),l(8),x("ngModel",n.newItem.requirements.strength),l(4),x("ngModel",n.newItem.requirements.dexterity),l(4),x("ngModel",n.newItem.requirements.speed),l(4),x("ngModel",n.newItem.requirements.intelligence),l(4),x("ngModel",n.newItem.requirements.constitution),l(4),x("ngModel",n.newItem.requirements.chill),l(8),x("ngModel",n.tempModifiers.strength),l(4),x("ngModel",n.tempModifiers.dexterity),l(4),x("ngModel",n.tempModifiers.speed),l(4),x("ngModel",n.tempModifiers.intelligence),l(4),x("ngModel",n.tempModifiers.constitution),l(4),x("ngModel",n.tempModifiers.chill),l(4),x("ngModel",n.tempModifiers.mana),l(4),x("ngModel",n.tempModifiers.life),l(4),x("ngModel",n.tempModifiers.energy))},dependencies:[B,N,ye,V,J,A,we,Me,Q,F,ke],styles:[".creator-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;font-size:.9rem}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:.6rem;border:1px solid var(--border);border-radius:4px;font-family:inherit;font-size:.95rem}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#4caf50}.field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical}.requirements-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.requirements-section[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{font-weight:500;font-size:.9rem}.requirements-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:.5rem}.req-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.req-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.8rem;color:#666;font-weight:500}.req-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.5rem;border:1px solid var(--border);border-radius:4px;font-size:.85rem}.req-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#4caf50}.button-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.5rem}.button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.75rem;border:none;border-radius:4px;cursor:pointer;font-size:.95rem;font-weight:500;transition:all .2s}.create-btn[_ngcontent-%COMP%]{background-color:var(--accent);color:#fff}.create-btn[_ngcontent-%COMP%]:hover{background-color:var(--accentdark)}.cancel-btn[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#333}.cancel-btn[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}"]})};var W=class{static styles=[{keywords:["kosten","bedingung","bedingungen","voraussetzung","voraussetzungen","effektivit\xE4t","effekt"],className:"keyword-bold",color:"#A9A9A9"},{keywords:["leben","trefferpunkte"],className:"keyword-life",color:"#FF6B6B"},{keywords:["ausdauer"],className:"keyword-energy",color:"#4ECDC4"},{keywords:["mana"],className:"keyword-mana",color:"#45A1FF"},{keywords:["fokus"],className:"keyword-fokus",color:"#9D6BFF"},{keywords:["st\xE4rke","str"],className:"keyword-stat",color:"#FF9F6B"},{keywords:["geschicklichkeit","dex"],className:"keyword-stat",color:"#26D0B3"},{keywords:["intelligenz","int"],className:"keyword-stat",color:"#54A0FF"},{keywords:["konstitution","con","hp","health"],className:"keyword-stat",color:"#FF7675"}];static enhance(t){if(!t)return"";let e=t,n=[];for(let i of this.styles)for(let o of i.keywords){let _=new RegExp(`\\b${this.escapeRegex(o)}\\b`,"gi"),O;for(;(O=_.exec(t))!==null;){let E=O.index,j=E+O[0].length;if(!n.some(K=>E>=K.start&&E<K.end||j>K.start&&j<=K.end)){let K=`<span class="${i.className}" style="color: ${i.color}; font-weight: 700;">${O[0]}</span>`;n.push({start:E,end:j,replacement:K})}}}n.sort((i,o)=>o.start-i.start);for(let{start:i,end:o,replacement:_}of n)e=e.substring(0,i)+_+e.substring(o);return e}static escapeRegex(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}static addKeywordStyle(t){this.styles.push(t)}static getStyles(){return this.styles}};function Ne(s,t){if(s&1&&(r(0,"span",6),c(1),a()),s&2){let e=d(2);l(),y("-",e.item.armorDebuff," SPD")}}function We(s,t){s&1&&(r(0,"span",7),c(1,"Cannot Use"),a())}function Ke(s,t){if(s&1&&(r(0,"span",13),c(1),a()),s&2){let e=d(3);b("unmet",e.sheet.strength.current<e.item.requirements.strength),l(),y(" STR ",e.item.requirements.strength," ")}}function Le(s,t){if(s&1&&(r(0,"span",13),c(1),a()),s&2){let e=d(3);b("unmet",e.sheet.dexterity.current<e.item.requirements.dexterity),l(),y(" DEX ",e.item.requirements.dexterity," ")}}function He(s,t){if(s&1&&(r(0,"span",13),c(1),a()),s&2){let e=d(3);b("unmet",e.sheet.speed.current<e.item.requirements.speed),l(),y(" SPD ",e.item.requirements.speed," ")}}function qe(s,t){if(s&1&&(r(0,"span",13),c(1),a()),s&2){let e=d(3);b("unmet",e.sheet.intelligence.current<e.item.requirements.intelligence),l(),y(" INT ",e.item.requirements.intelligence," ")}}function Ge(s,t){if(s&1&&(r(0,"span",13),c(1),a()),s&2){let e=d(3);b("unmet",e.sheet.constitution.current<e.item.requirements.constitution),l(),y(" CON ",e.item.requirements.constitution," ")}}function je(s,t){if(s&1&&(r(0,"span",13),c(1),a()),s&2){let e=d(3);b("unmet",e.sheet.chill.current<e.item.requirements.chill),l(),y(" CHL ",e.item.requirements.chill," ")}}function Ye(s,t){if(s&1&&(r(0,"div",10)(1,"span",11),c(2,"Requires:"),a(),h(3,Ke,2,3,"span",12),h(4,Le,2,3,"span",12),h(5,He,2,3,"span",12),h(6,qe,2,3,"span",12),h(7,Ge,2,3,"span",12),h(8,je,2,3,"span",12),a()),s&2){let e=d(2);l(3),f(e.item.requirements.strength?3:-1),l(),f(e.item.requirements.dexterity?4:-1),l(),f(e.item.requirements.speed?5:-1),l(),f(e.item.requirements.intelligence?6:-1),l(),f(e.item.requirements.constitution?7:-1),l(),f(e.item.requirements.chill?8:-1)}}function Ue(s,t){if(s&1){let e=C();r(0,"div",1)(1,"div",3)(2,"h4"),c(3),a(),r(4,"div",4)(5,"span",5),c(6),a(),h(7,Ne,2,1,"span",6),h(8,We,2,0,"span",7),r(9,"button",8),m("click",function(i){return p(e),d().deleteItem(),g(i.stopPropagation())}),c(10,"\u{1F5D1}\uFE0F"),a()()(),M(11,"p",9),h(12,Ye,9,6,"div",10),a()}if(s&2){let e=d();l(3),T(e.item.name),l(3),y("",e.item.weight," kg"),l(),f(e.item.armorDebuff?7:-1),l(),f(e.canUseItem?-1:8),l(3),u("innerHTML",e.enhancedDescription,L),l(),f(e.item.requirements&&(e.item.requirements.strength||e.item.requirements.dexterity||e.item.requirements.speed||e.item.requirements.intelligence||e.item.requirements.constitution||e.item.requirements.chill)?12:-1)}}function Ze(s,t){if(s&1){let e=C();r(0,"div",14),m("click",function(i){return p(e),g(i.stopPropagation())}),r(1,"div",15)(2,"label"),c(3,"Name"),a(),r(4,"input",16),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("name",i))}),a()(),r(5,"div",17)(6,"div",15)(7,"label"),c(8,"Weight (kg)"),a(),r(9,"input",18),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("weight",+i))}),a()(),r(10,"div",15)(11,"label"),c(12,"Armor Debuff (Speed -)"),a(),r(13,"input",19),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("armorDebuff",+i))}),a()()(),r(14,"div",20)(15,"label"),c(16,"Verloren"),a(),r(17,"input",21),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("lost",+i))}),a()(),r(18,"div",15)(19,"label"),c(20,"Description"),a(),r(21,"textarea",22),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("description",i))}),a()(),r(22,"div",23)(23,"label"),c(24,"Requirements"),a(),r(25,"div",24)(26,"div",25)(27,"label"),c(28,"STR"),a(),r(29,"input",26),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("requirements.strength",i?+i:void 0))}),a()(),r(30,"div",25)(31,"label"),c(32,"DEX"),a(),r(33,"input",26),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("requirements.dexterity",i?+i:void 0))}),a()(),r(34,"div",25)(35,"label"),c(36,"SPD"),a(),r(37,"input",26),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("requirements.speed",i?+i:void 0))}),a()(),r(38,"div",25)(39,"label"),c(40,"INT"),a(),r(41,"input",26),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("requirements.intelligence",i?+i:void 0))}),a()(),r(42,"div",25)(43,"label"),c(44,"CON"),a(),r(45,"input",26),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("requirements.constitution",i?+i:void 0))}),a()(),r(46,"div",25)(47,"label"),c(48,"CHL"),a(),r(49,"input",26),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("requirements.chill",i?+i:void 0))}),a()()()(),r(50,"div",27)(51,"button",28),m("click",function(){p(e);let i=d();return g(i.toggleEdit())}),c(52,"Done"),a()()()}if(s&2){let e=d();l(4),u("ngModel",e.item.name),l(5),u("ngModel",e.item.weight),l(4),u("ngModel",e.item.armorDebuff||0),l(4),u("ngModel",e.item.lost),l(4),u("ngModel",e.item.description),l(8),u("ngModel",(e.item.requirements==null?null:e.item.requirements.strength)||""),l(4),u("ngModel",(e.item.requirements==null?null:e.item.requirements.dexterity)||""),l(4),u("ngModel",(e.item.requirements==null?null:e.item.requirements.speed)||""),l(4),u("ngModel",(e.item.requirements==null?null:e.item.requirements.intelligence)||""),l(4),u("ngModel",(e.item.requirements==null?null:e.item.requirements.constitution)||""),l(4),u("ngModel",(e.item.requirements==null?null:e.item.requirements.chill)||"")}}var ze=class s{constructor(t,e){this.cd=t;this.sanitizer=e}item;sheet;index;isEditing=!1;patch=new k;delete=new k;editingChange=new k;get enhancedDescription(){let t=this.item.description||"No description",e=W.enhance(t);return this.sanitizer.bypassSecurityTrustHtml(e)}get canUseItem(){if(!this.item.requirements)return!0;let t=this.item.requirements,e=this.sheet;return!(t.strength&&e.strength.current<t.strength||t.dexterity&&e.dexterity.current<t.dexterity||t.speed&&e.speed.current<t.speed||t.intelligence&&e.intelligence.current<t.intelligence||t.constitution&&e.constitution.current<t.constitution||t.chill&&e.chill.current<t.chill||this.item.lost)}toggleEdit(){this.editingChange.emit(!this.isEditing)}updateField(t,e){this.patch.emit({path:t,value:e}),this.cd.detectChanges()}deleteItem(){this.delete.emit()}static \u0275fac=function(e){return new(e||s)(S(q),S(G))};static \u0275cmp=I({type:s,selectors:[["app-item"]],inputs:{item:"item",sheet:"sheet",index:"index",isEditing:"isEditing"},outputs:{patch:"patch",delete:"delete",editingChange:"editingChange"},decls:3,vars:5,consts:[[1,"item-card",3,"dblclick"],[1,"item-view"],[1,"item-edit"],[1,"item-header"],[1,"item-badges"],[1,"item-weight"],[1,"item-armor-debuff"],[1,"item-unusable-badge"],["title","Delete",1,"delete-btn-compact",3,"click"],[1,"item-description",3,"innerHTML"],[1,"item-requirements"],[1,"req-label"],[1,"req-stat",3,"unmet"],[1,"req-stat"],[1,"item-edit",3,"click"],[1,"field"],["type","text",3,"ngModelChange","ngModel"],[1,"field-row"],["type","number","step","0.1","min","0",3,"ngModelChange","ngModel"],["type","number","min","0","placeholder","0",3,"ngModelChange","ngModel"],[1,"field","checkbox-field"],["type","checkbox",3,"ngModelChange","ngModel"],["rows","3",3,"ngModelChange","ngModel"],[1,"requirements-section"],[1,"requirements-grid"],[1,"req-field"],["type","number","min","0","placeholder","-",3,"ngModelChange","ngModel"],[1,"item-actions"],[1,"save-btn",3,"click"]],template:function(e,n){e&1&&(r(0,"div",0),m("dblclick",function(){return!n.isEditing&&n.toggleEdit()}),h(1,Ue,13,6,"div",1)(2,Ze,53,11,"div",2),a()),e&2&&(b("editing",n.isEditing)("unusable",!n.canUseItem),l(),f(n.isEditing?2:1))},dependencies:[B,N,V,J,X,A,Q,F],styles:["[_nghost-%COMP%]{display:block;width:100%}.item-card[_ngcontent-%COMP%]{background:var(--card);border:1px solid var(--border);border-radius:6px;padding:1rem;transition:all .2s;border-left:3px solid var(--accent);cursor:grab;width:100%;box-sizing:border-box}.item-card[_ngcontent-%COMP%]:active{cursor:grabbing}.item-card.editing[_ngcontent-%COMP%]{cursor:default}.item-card.unusable[_ngcontent-%COMP%]{opacity:.7;background:var(--bg);border-left-color:#e53935}.item-card[_ngcontent-%COMP%]:not(.editing):hover{box-shadow:0 2px 8px #0003;border-color:var(--accent);transform:translateY(-2px)}.item-card.editing[_ngcontent-%COMP%]{background:#2c3a4f;border-color:var(--accent);opacity:1;cursor:default}.item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem;gap:1rem}.item-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;color:var(--text);word-break:break-word;flex:1;min-width:0;font-weight:600}.item-badges[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap;flex-shrink:0}.item-weight[_ngcontent-%COMP%]{background:var(--bg);color:var(--text-muted);padding:.25rem .5rem;border-radius:4px;font-size:.8rem;border:1px solid var(--border);white-space:nowrap}.item-unusable-badge[_ngcontent-%COMP%]{background:#4d1c21;color:#ffcdd2;padding:.25rem .5rem;border-radius:4px;font-size:.8rem;border:1px solid #e57373;white-space:nowrap}.item-armor-debuff[_ngcontent-%COMP%]{background:#4a2c00;color:#f97316;padding:.25rem .5rem;border-radius:4px;font-size:.8rem;border:1px solid #f97316;white-space:nowrap;font-weight:600}.field-row[_ngcontent-%COMP%]{display:flex;gap:1rem}.field-row[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{flex:1}.item-description[_ngcontent-%COMP%]{color:var(--text-muted);margin:.5rem 0;font-size:.9rem;line-height:1.5;word-wrap:break-word;overflow-wrap:break-word;white-space:pre-wrap}.item-requirements[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap;margin-top:.75rem;padding-top:.75rem;border-top:1px solid var(--border)}.req-label[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text-muted);font-weight:600}.req-stat[_ngcontent-%COMP%]{background:#1e3a5f;color:#90caf9;padding:.2rem .5rem;border-radius:4px;font-size:.8rem;border:1px solid #42a5f5;white-space:nowrap;font-weight:600}.req-stat.unmet[_ngcontent-%COMP%]{background:#4d1c21;color:#ffcdd2;border-color:#e57373;text-decoration:line-through}.item-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.75rem}.item-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;transition:all .2s;flex:1;font-weight:600}.save-btn[_ngcontent-%COMP%]{background-color:var(--accent);color:#fff}.save-btn[_ngcontent-%COMP%]:hover{background-color:var(--accentdark);transform:translateY(-1px);box-shadow:0 2px 4px #4caf504d}.delete-btn[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#e53935;transform:translateY(-1px);box-shadow:0 2px 4px #f443364d}.field[_ngcontent-%COMP%]{margin-bottom:1rem}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.25rem;font-weight:500;font-size:.9rem;color:var(--text)}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid var(--border);border-radius:4px;font-family:inherit;font-size:.9rem;box-sizing:border-box;background:var(--bg);color:var(--text)}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--accent)}.field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical}.requirements-section[_ngcontent-%COMP%]{margin-bottom:1rem}.requirements-section[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:500;font-size:.9rem;color:var(--text)}.requirements-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:.5rem}.req-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.req-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.8rem;color:var(--text);font-weight:500}.req-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.4rem;border:1px solid var(--border);border-radius:4px;font-size:.85rem;background:var(--bg);color:var(--text)}.req-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--accent)}.item-edit[_ngcontent-%COMP%]{pointer-events:all}.checkbox-field[_ngcontent-%COMP%]{flex-direction:row!important;align-items:center}.checkbox-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;margin-bottom:0}.checkbox-field[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:auto;cursor:pointer}.delete-btn-compact[_ngcontent-%COMP%]{background:transparent;border:none;cursor:pointer;font-size:1.2rem;padding:.25rem .5rem;opacity:.6;transition:all .2s;border-radius:4px}.delete-btn-compact[_ngcontent-%COMP%]:hover{opacity:1;background:#f443361a;transform:scale(1.1)}"]})};var De=[{name:"Purple",value:"#8b5cf6"},{name:"Blue",value:"#3b82f6"},{name:"Cyan",value:"#06b6d4"},{name:"Green",value:"#22c55e"},{name:"Yellow",value:"#eab308"},{name:"Orange",value:"#f97316"},{name:"Red",value:"#ef4444"},{name:"Pink",value:"#ec4899"},{name:"White",value:"#ffffff"}],Re=["Fire","Water","Earth","Air","Light","Dark","Healing","Protection","Attack","Defense","Buff","Debuff","Summoning","Enchantment","Illusion","Divination","Transmutation","Necromancy"];var Je=["canvas"];function Qe(s,t){if(s&1&&(r(0,"div",4),M(1,"img",14),U(2,"imageUrl"),a()),s&2){let e=d(2);l(),u("src",Z(2,1,e.spell.drawing),Y)}}function $e(s,t){s&1&&(r(0,"span",8),c(1,"Learned"),a())}function et(s,t){if(s&1&&(r(0,"span",16),c(1),a()),s&2){let e=d(3);l(),ve("",e.spell.binding.durability,"/",e.spell.binding.maxDurability)}}function tt(s,t){if(s&1&&(r(0,"span",15),c(1),h(2,et,2,2,"span",16),a()),s&2){let e=d(2);b("missing",e.isDisabled),l(),y(" ",e.spell.binding.itemName," "),l(),f(e.spell.binding.durability!==void 0?2:-1)}}function nt(s,t){if(s&1&&(r(0,"span",12),c(1),a()),s&2){let e=t.$implicit;l(),T(e)}}function it(s,t){if(s&1){let e=C();r(0,"div",2)(1,"div",3),h(2,Qe,3,3,"div",4),r(3,"div",5)(4,"div",6)(5,"h4"),c(6),a(),r(7,"div",7),h(8,$e,2,0,"span",8)(9,tt,3,4,"span",9),r(10,"button",10),m("click",function(i){return p(e),d().deleteSpell(),g(i.stopPropagation())}),c(11,"\u{1F5D1}\uFE0F"),a()()(),r(12,"div",11),D(13,nt,2,1,"span",12,z),a()()(),M(15,"p",13),a()}if(s&2){let e=d();l(2),f(e.spell.drawing?2:-1),l(4),T(e.spell.name),l(2),f(e.spell.binding.type==="learned"?8:9),l(5),R(e.spell.tags),l(2),u("innerHTML",e.enhancedDescription,L)}}function rt(s,t){if(s&1){let e=C();r(0,"button",56),m("click",function(){let i=p(e).$implicit,o=d(4);return g(o.selectColor(i))}),a()}if(s&2){let e=t.$implicit,n=d(4);H("background",e)("border-color",e==="#ffffff"?"#666":e),b("active",n.strokeColor===e),u("title",e)}}function at(s,t){if(s&1){let e=C();r(0,"div",40)(1,"div",51),D(2,rt,1,7,"button",52,z),r(4,"label",53)(5,"input",54),m("input",function(i){p(e);let o=d(3);return g(o.onColorInput(i))}),a(),M(6,"span",55),a()()()}if(s&2){let e=d(3);l(2),R(e.presetColors),l(3),u("value",e.strokeColor),l(),H("background",e.strokeColor)}}function ot(s,t){if(s&1){let e=C();r(0,"button",60),m("click",function(){let i=p(e).$implicit,o=d(4);return g(o.selectEraserSize(i))}),M(1,"span",61),a()}if(s&2){let e=t.$implicit,n=d(4);b("active",n.eraserSize===e),u("title",e+"px"),l(),H("width",n.Math.min(e,24),"px")("height",n.Math.min(e,24),"px")}}function st(s,t){if(s&1&&(r(0,"div",40)(1,"span",57),c(2,"Eraser Size:"),a(),r(3,"div",58),D(4,ot,2,7,"button",59,z),a()()),s&2){let e=d(3);l(4),R(e.eraserSizes)}}function lt(s,t){if(s&1){let e=C();r(0,"div",17)(1,"div",32)(2,"h3"),c(3,"\u2728 Edit Spell Drawing"),a(),r(4,"button",33),m("click",function(){p(e);let i=d(2);return g(i.closeFullscreenDrawing())}),c(5,"\u2715 Close"),a()(),r(6,"div",34)(7,"div",35)(8,"div",36)(9,"button",37),m("click",function(){p(e);let i=d(2);return g(i.setDrawMode())}),r(10,"span",38),c(11,"\u270F\uFE0F"),a()(),r(12,"button",39),m("click",function(){p(e);let i=d(2);return g(i.toggleEraser())}),r(13,"span",38),c(14,"\u{1F9F9}"),a()()(),h(15,at,7,3,"div",40),h(16,st,6,0,"div",40),r(17,"div",41)(18,"button",42),m("click",function(){p(e);let i=d(2);return g(i.undo())}),r(19,"span",38),c(20,"\u21B6"),a(),c(21," Undo "),a(),r(22,"button",43),m("click",function(){p(e);let i=d(2);return g(i.clearCanvas())}),r(23,"span",38),c(24,"\u{1F5D1}\uFE0F"),a(),c(25," Clear "),a()()(),r(26,"div",44)(27,"button",45),m("click",function(){p(e);let i=d(2);return g(i.expandTop())}),c(28,"\u25B2"),a(),r(29,"button",46),m("click",function(){p(e);let i=d(2);return g(i.expandLeft())}),c(30,"\u25C4"),a(),r(31,"button",47),m("click",function(){p(e);let i=d(2);return g(i.expandRight())}),c(32,"\u25BA"),a(),r(33,"button",48),m("click",function(){p(e);let i=d(2);return g(i.expandBottom())}),c(34,"\u25BC"),a(),r(35,"div",49)(36,"canvas",50,0),m("pointerdown",function(i){p(e);let o=d(2);return g(o.startDrawing(i))})("pointermove",function(i){p(e);let o=d(2);return g(o.draw(i))})("pointerup",function(){p(e);let i=d(2);return g(i.stopDrawing())})("pointerleave",function(){p(e);let i=d(2);return g(i.stopDrawing())})("pointercancel",function(){p(e);let i=d(2);return g(i.stopDrawing())}),a()()()()()}if(s&2){let e=d(2);l(9),b("active",!e.isErasing()),l(3),b("active",e.isErasing()),l(3),f(e.isErasing()?-1:15),l(),f(e.isErasing()?16:-1),l(19),b("panning",e.isPanning()),l(),ne("width",e.canvasWidth())("height",e.canvasHeight())}}function ct(s,t){if(s&1&&(r(0,"div",62),M(1,"img",64),U(2,"imageUrl"),a()),s&2){let e=d(4);l(),u("src",Z(2,1,e.spell.drawing),Y)}}function dt(s,t){if(s&1){let e=C();h(0,ct,3,3,"div",62),r(1,"button",63),m("click",function(){p(e);let i=d(3);return g(i.openFullscreenDrawing())}),c(2," \u{1F4DD} Edit Drawing in Fullscreen "),a()}if(s&2){let e=d(3);f(e.spell.drawing?0:-1)}}function pt(s,t){if(s&1&&(r(0,"div",19)(1,"label"),c(2,"Draw Spell Symbol"),a(),h(3,dt,3,1),a()),s&2){let e=d(2);l(3),f(e.hasDrawing?3:-1)}}function gt(s,t){if(s&1&&(r(0,"option",67),c(1),a()),s&2){let e=t.$implicit;u("value",e),l(),T(e)}}function mt(s,t){if(s&1){let e=C();r(0,"div",19)(1,"label"),c(2,"Bound Item"),a(),r(3,"select",65),m("ngModelChange",function(i){p(e);let o=d(2);return g(o.updateField("binding.itemName",i))}),r(4,"option",66),c(5,"Select an item..."),a(),D(6,gt,2,2,"option",67,z),a()(),r(8,"div",68)(9,"div",19)(10,"label"),c(11,"Durability"),a(),r(12,"input",69),m("ngModelChange",function(i){p(e);let o=d(2);return g(o.updateField("binding.durability",+i))}),a()(),r(13,"div",19)(14,"label"),c(15,"Max Durability"),a(),r(16,"input",70),m("ngModelChange",function(i){p(e);let o=d(2);return g(o.updateField("binding.maxDurability",+i))}),a()()()}if(s&2){let e=d(2);l(3),u("ngModel",e.spell.binding.itemName),l(3),R(e.availableItems),l(6),u("ngModel",e.spell.binding.durability||0),l(4),u("ngModel",e.spell.binding.maxDurability||10)}}function ut(s,t){if(s&1){let e=C();r(0,"button",71),m("click",function(){let i=p(e).$implicit,o=d(2);return g(o.toggleTag(i))}),c(1),a()}if(s&2){let e=t.$implicit,n=d(2);b("selected",n.hasTag(e)),l(),y(" ",e," ")}}function ht(s,t){if(s&1){let e=C();h(0,lt,38,10,"div",17),r(1,"div",18),m("click",function(i){return p(e),g(i.stopPropagation())}),r(2,"div",19)(3,"label"),c(4,"Name"),a(),r(5,"input",20),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("name",i))}),a()(),r(6,"div",19)(7,"label"),c(8,"Description"),a(),r(9,"textarea",21),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("description",i))}),a()(),r(10,"div",22)(11,"label",23)(12,"input",24),w("ngModelChange",function(i){p(e);let o=d();return v(o.hasDrawing,i)||(o.hasDrawing=i),g(i)}),a(),r(13,"span"),c(14,"Add spell symbol drawing"),a()()(),h(15,pt,4,1,"div",19),r(16,"div",19)(17,"label"),c(18,"Binding Type"),a(),r(19,"div",25)(20,"label",26)(21,"input",27),m("change",function(){p(e);let i=d();return g(i.updateField("binding.type","learned"))}),a(),c(22," Learned "),a(),r(23,"label",26)(24,"input",27),m("change",function(){p(e);let i=d();return g(i.updateField("binding.type","item"))}),a(),c(25," Item-Bound "),a()()(),h(26,mt,17,3),r(27,"div",19)(28,"label"),c(29,"Tags"),a(),r(30,"div",28),D(31,ut,2,3,"button",29,z),a()(),r(33,"div",30)(34,"button",31),m("click",function(){p(e);let i=d();return g(i.toggleEdit())}),c(35,"Done"),a()()()}if(s&2){let e=d();f(e.hasDrawing&&e.isFullscreenDrawing()?0:-1),l(5),u("ngModel",e.spell.name),l(4),u("ngModel",e.spell.description),l(3),x("ngModel",e.hasDrawing),l(3),f(e.hasDrawing?15:-1),l(6),u("checked",e.spell.binding.type==="learned"),l(3),u("checked",e.spell.binding.type==="item"),l(2),f(e.spell.binding.type==="item"?26:-1),l(5),R(e.tagOptions)}}var Te=class s{constructor(t,e,n){this.cd=t;this.sanitizer=e;this.imageService=n}canvasRef;spell;sheet;index;isEditing=!1;patch=new k;delete=new k;editingChange=new k;tagOptions=Re;glowColors=De;hasDrawing=!1;canvasWidth=P(600);canvasHeight=P(300);isErasing=P(!1);isPanning=P(!1);isFullscreenDrawing=P(!1);presetColors=["#ff0000","#ff6600","#ffcc00","#00ff00","#00ffff","#0066ff","#6600ff","#ff00ff","#ffffff","#000000"];eraserSizes=[10,20,30,40];eraserSize=20;Math=Math;ctx;isDrawing=!1;lastX=0;lastY=0;expandAmount=200;undoHistory=[];maxUndoSteps=20;panStartX=0;panStartY=0;canvasInitialized=!1;ngOnInit(){document.addEventListener("keydown",this.handleKeyDown.bind(this))}ngOnDestroy(){document.removeEventListener("keydown",this.handleKeyDown.bind(this))}handleKeyDown(t){(t.ctrlKey||t.metaKey)&&t.key==="z"&&this.isEditing&&this.hasDrawing&&this.isDrawing===!1&&(t.preventDefault(),this.undo())}ngAfterViewInit(){this.tryInitCanvas()}ngAfterViewChecked(){this.tryInitCanvas()}tryInitCanvas(){this.isEditing&&this.hasDrawing&&this.canvasRef&&!this.canvasInitialized?(this.initCanvas(),this.canvasInitialized=!0):(!this.isEditing||!this.hasDrawing)&&(this.canvasInitialized=!1)}toggleDrawing(){this.hasDrawing=!this.hasDrawing,this.canvasInitialized=!1,this.hasDrawing||this.updateField("drawing",void 0)}get strokeColor(){return this.spell.strokeColor||"#673ab7"}initCanvas(){if(!this.canvasRef)return;let t=this.canvasRef.nativeElement;if(this.ctx=t.getContext("2d"),this.ctx.lineWidth=2,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.strokeStyle=this.strokeColor,this.ctx.shadowColor=this.strokeColor,this.ctx.shadowBlur=20,this.spell.drawing){let e=new Image;e.onload=()=>{this.canvasWidth.set(e.width),this.canvasHeight.set(e.height),requestAnimationFrame(()=>{this.ctx&&(this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,t.width,t.height),this.ctx.drawImage(e,0,0),this.ctx.strokeStyle=this.strokeColor,this.ctx.shadowColor=this.strokeColor,this.ctx.shadowBlur=20,this.ctx.lineWidth=2,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.saveToHistory())})},e.src=this.imageService.getImageUrl(this.spell.drawing)||""}else this.clearCanvas(),this.saveToHistory()}get enhancedDescription(){let t=this.spell.description||"No description",e=W.enhance(t);return this.sanitizer.bypassSecurityTrustHtml(e)}get isDisabled(){if(this.spell.binding.type==="learned")return!1;let t=this.spell.binding.itemName?.toLowerCase().trim();return t?![...this.sheet.inventory||[],...this.sheet.equipment||[]].some(n=>n.name.toLowerCase().trim()===t):!0}get availableItems(){return[...this.sheet.inventory||[],...this.sheet.equipment||[]].map(e=>e.name)}async toggleEdit(){let t=!this.isEditing;if(this.editingChange.emit(t),t)this.hasDrawing=!!this.spell.drawing,setTimeout(()=>{this.hasDrawing&&this.canvasRef&&this.initCanvas(),this.cd.detectChanges()},0);else if(this.hasDrawing&&this.canvasRef){let n=this.canvasRef.nativeElement.toDataURL("image/png"),i=await this.imageService.uploadImage(n);this.updateField("drawing",i)}else this.hasDrawing||this.updateField("drawing",void 0)}startDrawing(t){if(this.canvasRef){if(t.button===1){t.preventDefault(),this.isPanning.set(!0);let e=this.canvasRef.nativeElement.parentElement;e&&(this.panStartX=t.clientX+e.scrollLeft,this.panStartY=t.clientY+e.scrollTop);return}if(t.button===0){this.isDrawing=!0;let e=this.canvasRef.nativeElement.getBoundingClientRect();this.lastX=t.clientX-e.left,this.lastY=t.clientY-e.top,this.saveToHistory()}}}draw(t){if(!this.canvasRef)return;if(this.isPanning()){let _=this.canvasRef.nativeElement.parentElement;_&&(_.scrollLeft=this.panStartX-t.clientX,_.scrollTop=this.panStartY-t.clientY);return}if(!this.isDrawing||!this.ctx)return;let e=this.canvasRef.nativeElement.getBoundingClientRect(),n=t.clientX-e.left,i=t.clientY-e.top;this.isErasing()?(this.ctx.globalCompositeOperation="destination-out",this.ctx.lineWidth=this.eraserSize,this.ctx.shadowBlur=0):(this.ctx.globalCompositeOperation="source-over",this.ctx.lineWidth=2),(this.isErasing()?[0]:[30,20,10,5]).forEach(_=>{this.ctx.shadowBlur=_,this.ctx.beginPath(),this.ctx.moveTo(this.lastX,this.lastY),this.ctx.lineTo(n,i),this.ctx.stroke()}),this.lastX=n,this.lastY=i}stopDrawing(){this.isDrawing=!1,this.isPanning.set(!1)}expandLeft(){this.expandCanvas("left")}expandRight(){this.expandCanvas("right")}expandTop(){this.expandCanvas("top")}expandBottom(){this.expandCanvas("bottom")}expandCanvas(t){let e=this.canvasRef?.nativeElement;if(!e||!this.ctx)return;let n=document.createElement("canvas");n.width=e.width,n.height=e.height;let i=n.getContext("2d");if(!i)return;i.drawImage(e,0,0);let o=this.canvasWidth(),_=this.canvasHeight(),O=0,E=0;switch(t){case"left":o+=this.expandAmount,O=this.expandAmount;break;case"right":o+=this.expandAmount;break;case"top":_+=this.expandAmount,E=this.expandAmount;break;case"bottom":_+=this.expandAmount;break}this.canvasWidth.set(o),this.canvasHeight.set(_),requestAnimationFrame(()=>{this.ctx&&e&&(this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,e.width,e.height),this.ctx.drawImage(n,O,E),this.ctx.lineWidth=2,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.strokeStyle=this.strokeColor,this.ctx.shadowColor=this.strokeColor,this.ctx.shadowBlur=20,this.ctx.globalCompositeOperation=this.isErasing()?"destination-out":"source-over",this.saveToHistory())})}clearCanvas(){!this.canvasRef||!this.ctx||(this.canvasWidth.set(600),this.canvasHeight.set(300),this.undoHistory=[],setTimeout(()=>{if(!this.ctx||!this.canvasRef)return;let t=this.canvasRef.nativeElement;this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,t.width,t.height),this.ctx.strokeStyle=this.strokeColor,this.ctx.shadowColor=this.strokeColor,this.ctx.shadowBlur=20,this.ctx.lineWidth=2,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.saveToHistory()},0))}updateField(t,e){this.patch.emit({path:t,value:e}),this.cd.detectChanges()}toggleTag(t){this.spell.tags||(this.spell.tags=[]);let e=this.spell.tags.indexOf(t),n;e>-1?n=this.spell.tags.filter(i=>i!==t):n=[...this.spell.tags,t],this.updateField("tags",n)}updateStrokeColor(t){this.updateField("strokeColor",t),this.ctx&&(this.ctx.strokeStyle=t,this.ctx.shadowColor=t)}hasTag(t){return this.spell.tags?.includes(t)||!1}deleteSpell(){this.delete.emit()}handleTouch(t){if(t.preventDefault(),!this.canvasRef)return;let e=t.touches[0],n=this.canvasRef.nativeElement.getBoundingClientRect();this.isDrawing=!0,this.lastX=e.clientX-n.left,this.lastY=e.clientY-n.top}handleTouchMove(t){if(t.preventDefault(),!this.isDrawing||!this.ctx||!this.canvasRef)return;let e=t.touches[0],n=this.canvasRef.nativeElement.getBoundingClientRect(),i=e.clientX-n.left,o=e.clientY-n.top;this.ctx.beginPath(),this.ctx.moveTo(this.lastX,this.lastY),this.ctx.lineTo(i,o),this.ctx.stroke(),this.lastX=i,this.lastY=o}toggleEraser(){this.isErasing.set(!this.isErasing())}setDrawMode(){this.isErasing.set(!1)}selectColor(t){this.updateField("strokeColor",t),this.ctx&&(this.ctx.strokeStyle=t,this.ctx.shadowColor=t)}onColorInput(t){let e=t.target;this.selectColor(e.value)}selectEraserSize(t){this.eraserSize=t}openFullscreenDrawing(){this.isFullscreenDrawing.set(!0),setTimeout(()=>{this.canvasRef&&(this.canvasInitialized=!1,this.initCanvas(),this.canvasInitialized=!0)},0)}async closeFullscreenDrawing(){if(this.hasDrawing&&this.canvasRef){let e=this.canvasRef.nativeElement.toDataURL("image/png"),n=await this.imageService.uploadImage(e);this.updateField("drawing",n)}this.isFullscreenDrawing.set(!1)}saveToHistory(){if(!this.canvasRef||!this.ctx)return;let t=this.canvasRef.nativeElement,e=this.ctx.getImageData(0,0,t.width,t.height);this.undoHistory.push(e),this.undoHistory.length>this.maxUndoSteps&&this.undoHistory.shift()}undo(){if(!this.canvasRef||!this.ctx||this.undoHistory.length<2)return;this.undoHistory.pop();let t=this.undoHistory[this.undoHistory.length-1];if(t){let e=this.canvasRef.nativeElement;this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,e.width,e.height),this.ctx.putImageData(t,0,0),this.ctx.strokeStyle=this.strokeColor,this.ctx.shadowColor=this.strokeColor,this.ctx.shadowBlur=20,this.ctx.lineWidth=2,this.ctx.lineCap="round",this.ctx.lineJoin="round"}}static \u0275fac=function(e){return new(e||s)(S(q),S(G),S(ce))};static \u0275cmp=I({type:s,selectors:[["app-spell"]],viewQuery:function(e,n){if(e&1&&ie(Je,5),e&2){let i;re(i=ae())&&(n.canvasRef=i.first)}},inputs:{spell:"spell",sheet:"sheet",index:"index",isEditing:"isEditing"},outputs:{patch:"patch",delete:"delete",editingChange:"editingChange"},decls:3,vars:5,consts:[["canvas",""],[1,"spell-card",3,"dblclick"],[1,"spell-view"],[1,"spell-header"],[1,"spell-drawing"],[1,"spell-info"],[1,"spell-title-row"],[1,"spell-badges"],[1,"binding-badge","learned"],[1,"binding-badge","item",3,"missing"],["title","Delete",1,"delete-btn-compact",3,"click"],[1,"spell-tags"],[1,"tag"],[1,"spell-description",3,"innerHTML"],["alt","Spell symbol",3,"src"],[1,"binding-badge","item"],[1,"durability"],[1,"fullscreen-overlay"],[1,"spell-edit",3,"click"],[1,"field"],["type","text",3,"ngModelChange","ngModel"],["rows","3",3,"ngModelChange","ngModel"],[1,"field","checkbox-field"],[1,"checkbox-label"],["type","checkbox","name","hasDrawing",3,"ngModelChange","ngModel"],[1,"binding-type-selector"],[1,"radio-label"],["type","radio",3,"change","checked"],[1,"tag-selector"],["type","button",1,"tag-option",3,"selected"],[1,"spell-actions"],[1,"save-btn",3,"click"],[1,"fullscreen-header"],["type","button",1,"close-fullscreen-btn",3,"click"],[1,"fullscreen-content"],[1,"drawing-toolbar"],[1,"toolbar-section","tools"],["type","button","title","Draw Mode",1,"toolbar-btn",3,"click"],[1,"btn-icon"],["type","button","title","Eraser Mode",1,"toolbar-btn",3,"click"],[1,"toolbar-section","brush-settings"],[1,"toolbar-section","actions"],["type","button","title","Undo (Ctrl+Z)",1,"action-btn",3,"click"],["type","button","title","Clear Drawing",1,"action-btn","clear",3,"click"],[1,"canvas-area"],["type","button","title","Expand Top",1,"expand-btn","expand-top",3,"click"],["type","button","title","Expand Left",1,"expand-btn","expand-left",3,"click"],["type","button","title","Expand Right",1,"expand-btn","expand-right",3,"click"],["type","button","title","Expand Bottom",1,"expand-btn","expand-bottom",3,"click"],[1,"fullscreen-canvas-wrapper"],[3,"pointerdown","pointermove","pointerup","pointerleave","pointercancel"],[1,"color-picker"],["type","button",1,"color-swatch",3,"active","background","border-color","title"],["title","Custom Color",1,"custom-color"],["type","color",3,"input","value"],[1,"custom-color-preview"],["type","button",1,"color-swatch",3,"click","title"],[1,"setting-label"],[1,"size-picker"],["type","button",1,"size-btn",3,"active","title"],["type","button",1,"size-btn",3,"click","title"],[1,"size-dot"],[1,"drawing-preview"],["type","button",1,"edit-drawing-btn",3,"click"],["alt","Spell drawing",3,"src"],[3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"durability-fields"],["type","number","min","0",3,"ngModelChange","ngModel"],["type","number","min","1",3,"ngModelChange","ngModel"],["type","button",1,"tag-option",3,"click"]],template:function(e,n){e&1&&(r(0,"div",1),m("dblclick",function(){return!n.isEditing&&n.toggleEdit()}),h(1,it,16,4,"div",2)(2,ht,36,8),a()),e&2&&(b("editing",n.isEditing)("disabled",n.isDisabled),l(),f(n.isEditing?2:1))},dependencies:[B,N,se,le,V,J,X,oe,A,Q,F,de],styles:['[_nghost-%COMP%]{display:block;width:100%}.spell-card[_ngcontent-%COMP%]{background:var(--card);border:1px solid var(--border);border-radius:6px;padding:1rem;transition:all .2s;border-left:3px solid #673ab7;cursor:grab;width:100%;box-sizing:border-box}.spell-card[_ngcontent-%COMP%]:active{cursor:grabbing}.spell-card.editing[_ngcontent-%COMP%]{cursor:default;border-color:var(--muted)}.spell-card.disabled[_ngcontent-%COMP%]{opacity:.6;background:var(--bg)}.spell-card[_ngcontent-%COMP%]:not(.editing):hover{box-shadow:0 2px 6px #0000001f;border-color:var(--accent);transform:translateY(-1px)}.spell-header[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:.5rem;align-items:flex-start}.spell-drawing[_ngcontent-%COMP%]{flex-shrink:0;width:200px;height:80px;border:2px solid var(--border);border-radius:4px;overflow:hidden;background:#000}.spell-drawing[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain}.spell-info[_ngcontent-%COMP%]{flex:1;min-width:0}.spell-title-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:1rem;margin-bottom:.5rem}.spell-title-row[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;color:var(--text);word-break:break-word;flex:1;min-width:0}.spell-badges[_ngcontent-%COMP%]{flex-shrink:0;display:flex;gap:.5rem;align-items:center}.delete-btn-compact[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--border);color:var(--text);border-radius:4px;cursor:pointer;font-size:1.2rem;padding:.25rem .5rem;transition:all .2s;flex-shrink:0}.delete-btn-compact[_ngcontent-%COMP%]:hover{background:#f44336;border-color:#f44336;color:#fff;transform:scale(1.1)}.binding-badge[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:3px;font-size:.8rem;font-weight:600;white-space:nowrap}.binding-badge.learned[_ngcontent-%COMP%]{background:#2e7d3233;color:#81c784;border:1px solid rgba(46,125,50,.4)}.binding-badge.item[_ngcontent-%COMP%]{background:#e6510033;color:#ff9800;border:1px solid rgba(230,81,0,.4)}.binding-badge.item.missing[_ngcontent-%COMP%]{background:#f4433633;color:#ef5350;border-color:#f4433666;text-decoration:line-through}.durability[_ngcontent-%COMP%]{margin-left:.25rem;font-size:.75rem}.spell-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.25rem}.tag[_ngcontent-%COMP%]{background:#1976d233;color:#64b5f6;padding:.2rem .5rem;border-radius:3px;font-size:.75rem;border:1px solid rgba(25,118,210,.4)}.spell-description[_ngcontent-%COMP%]{color:var(--text);margin:.5rem 0 0;font-size:.9rem;line-height:1.5;word-wrap:break-word;overflow-wrap:break-word;white-space:pre-wrap}@keyframes _ngcontent-%COMP%_spell-glow{0%,to{box-shadow:0 0 40px #673ab7,0 0 80px #673ab7cc,0 0 120px #673ab799,inset 0 0 20px #673ab766;filter:brightness(1.2)}50%{box-shadow:0 0 60px #673ab7,0 0 120px #673ab7,0 0 180px #673ab7cc,inset 0 0 30px #673ab799;filter:brightness(1.4)}}.spell-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.75rem}.spell-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;transition:all .2s;flex:1;font-weight:600}.save-btn[_ngcontent-%COMP%]{background-color:var(--accent);color:#fff}.save-btn[_ngcontent-%COMP%]:hover{background-color:var(--accentdark);transform:translateY(-1px);box-shadow:0 2px 4px #4caf504d}.delete-btn[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#e53935;transform:translateY(-1px);box-shadow:0 2px 4px #f443364d}.field[_ngcontent-%COMP%]{margin-bottom:1rem}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.25rem;font-weight:500;font-size:.9rem;color:var(--text)}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid var(--border);border-radius:4px;font-family:inherit;font-size:.9rem;box-sizing:border-box;background:var(--bg);color:var(--text)}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--accent)}.field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical}.binding-type-selector[_ngcontent-%COMP%]{display:flex;gap:1rem}.radio-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-weight:400}.radio-label[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{width:auto;cursor:pointer}.durability-fields[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.tag-selector[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.tag-option[_ngcontent-%COMP%]{padding:.4rem .8rem;background:var(--bg);color:var(--text);border:1px solid var(--border);border-radius:4px;cursor:pointer;font-size:.85rem;transition:all .2s}.tag-option[_ngcontent-%COMP%]:hover{background:var(--card);border-color:var(--accent)}.tag-option.selected[_ngcontent-%COMP%]{background:#1976d233;color:#64b5f6;border-color:#1976d266}.spell-edit[_ngcontent-%COMP%]{pointer-events:all}.canvas-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.canvas-container[_ngcontent-%COMP%]{border:2px solid var(--border);border-radius:4px;display:inline-block;background:#000;cursor:crosshair;overflow:auto;max-width:100%;max-height:70vh;touch-action:none}.canvas-container.panning[_ngcontent-%COMP%]{cursor:grab}.canvas-container.panning[_ngcontent-%COMP%]:active{cursor:grabbing}canvas[_ngcontent-%COMP%]{display:block;touch-action:none;background:#000;cursor:crosshair}.color-selector[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:.5rem}.color-option[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;border:2px solid var(--border);cursor:pointer;transition:all .2s;position:relative}.color-option[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.color-option.selected[_ngcontent-%COMP%]{border-color:var(--text);box-shadow:0 0 8px currentColor}.color-option.selected[_ngcontent-%COMP%]:after{content:"\\2713";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#000;font-size:14px;font-weight:700;text-shadow:0 0 2px #fff}.clear-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;background:#ff9800;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:.85rem;font-weight:600;transition:all .2s;align-self:flex-start}.clear-btn[_ngcontent-%COMP%]:hover{background:#f57c00;transform:translateY(-1px);box-shadow:0 2px 4px #ff98004d}.expand-btn[_ngcontent-%COMP%]{padding:.4rem .8rem;background:#f0f0f0;border:1px solid var(--border);border-radius:4px;cursor:pointer;font-size:1rem;transition:all .2s;min-width:40px}.expand-btn[_ngcontent-%COMP%]:hover{background:#d0d0d0;border-color:var(--accent)}.fullscreen-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000f2;z-index:10000;display:flex;flex-direction:column}.fullscreen-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;background:#ffffff1a;border-bottom:1px solid rgba(255,255,255,.2)}.fullscreen-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#fff;font-size:1.5rem}.close-fullscreen-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#ff5252;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:1rem;font-weight:600;transition:all .2s}.close-fullscreen-btn[_ngcontent-%COMP%]:hover{background:#ff1744;transform:translateY(-1px);box-shadow:0 4px 8px #ff525266}.fullscreen-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;padding:2rem;overflow:auto;width:100%}.drawing-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap;gap:1rem;padding:.5rem 1rem;background:var(--card);border:1px solid var(--border);border-radius:8px;margin-bottom:1.5rem;box-shadow:0 2px 8px #0000004d}.toolbar-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.toolbar-section.tools[_ngcontent-%COMP%]{background:var(--bg);padding:.25rem;border-radius:8px}.toolbar-btn[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:8px;background:transparent;border:1px solid transparent;color:var(--text);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.toolbar-btn[_ngcontent-%COMP%]:hover{background:var(--border)}.toolbar-btn.active[_ngcontent-%COMP%]{background:var(--accent);border-color:var(--accent);color:#fff;box-shadow:0 0 10px #8b5cf666}.btn-icon[_ngcontent-%COMP%]{font-size:1.4rem}.brush-settings[_ngcontent-%COMP%]{background:var(--bg);padding:.5rem;border-radius:8px;gap:1rem}.setting-label[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text);font-weight:500}.color-picker[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.color-swatch[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:all .2s}.color-swatch[_ngcontent-%COMP%]:hover{transform:scale(1.15)}.color-swatch.active[_ngcontent-%COMP%]{border-color:#fff;box-shadow:0 0 0 2px var(--accent);transform:scale(1.1)}.custom-color[_ngcontent-%COMP%]{position:relative;width:28px;height:28px;cursor:pointer}.custom-color[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0;width:100%;height:100%;cursor:pointer}.custom-color-preview[_ngcontent-%COMP%]{display:block;width:100%;height:100%;border-radius:50%;border:2px dashed var(--border);background:conic-gradient(red,#ff0,#0f0,#0ff,#00f,#f0f,red)}.size-picker[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.size-btn[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:6px;background:transparent;border:1px solid transparent;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.size-btn[_ngcontent-%COMP%]:hover{background:var(--border)}.size-btn.active[_ngcontent-%COMP%]{background:var(--accent);border-color:var(--accent)}.size-dot[_ngcontent-%COMP%]{border-radius:50%;background:var(--text);max-width:24px;max-height:24px}.size-btn.active[_ngcontent-%COMP%]   .size-dot[_ngcontent-%COMP%]{background:#fff}.toolbar-section.actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.action-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;background:var(--bg);border:1px solid var(--border);border-radius:6px;cursor:pointer;font-size:.9rem;color:var(--text);transition:all .2s;display:flex;align-items:center;gap:.25rem}.action-btn[_ngcontent-%COMP%]:hover{background:var(--border)}.action-btn.clear[_ngcontent-%COMP%]:hover{background:#f44;color:#fff;border-color:#f44}.canvas-area[_ngcontent-%COMP%]{position:relative;display:inline-block;margin:0 auto;padding:25px}.expand-btn[_ngcontent-%COMP%]{position:absolute;background:var(--card);border:2px solid rgba(255,255,255,.3);border-radius:6px;cursor:pointer;font-size:1.2rem;transition:all .2s;color:#fff;z-index:10;padding:.4rem;display:flex;align-items:center;justify-content:center;min-width:36px;min-height:36px;box-shadow:0 2px 8px #0006}.expand-btn[_ngcontent-%COMP%]:hover{background:var(--accent);color:#fff;border-color:var(--accent);transform:scale(1.1);box-shadow:0 4px 12px #8b5cf680}.expand-btn.expand-top[_ngcontent-%COMP%]{top:-20px;left:50%;transform:translate(-50%)}.expand-btn.expand-bottom[_ngcontent-%COMP%]{bottom:-20px;left:50%;transform:translate(-50%)}.expand-btn.expand-left[_ngcontent-%COMP%]{left:-20px;top:50%;transform:translateY(-50%)}.expand-btn.expand-right[_ngcontent-%COMP%]{right:-20px;top:50%;transform:translateY(-50%)}.expand-btn.expand-top[_ngcontent-%COMP%]:hover, .expand-btn.expand-bottom[_ngcontent-%COMP%]:hover{transform:translate(-50%) scale(1.1)}.expand-btn.expand-left[_ngcontent-%COMP%]:hover, .expand-btn.expand-right[_ngcontent-%COMP%]:hover{transform:translateY(-50%) scale(1.1)}.fullscreen-canvas-wrapper[_ngcontent-%COMP%]{background:#000;border:2px solid rgba(255,255,255,.3);border-radius:8px;overflow:auto;max-width:95vw;max-height:calc(95vh - 150px);box-shadow:0 8px 32px #0009}.fullscreen-canvas-wrapper[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{display:block;cursor:crosshair;touch-action:none}.fullscreen-canvas-wrapper.panning[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{cursor:grab}.fullscreen-canvas-wrapper.panning[_ngcontent-%COMP%]:active   canvas[_ngcontent-%COMP%]{cursor:grabbing}.drawing-preview[_ngcontent-%COMP%]{margin-bottom:1rem;border:2px solid var(--border);border-radius:8px;padding:1rem;background:#000;max-width:300px}.drawing-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;display:block}.edit-drawing-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:var(--accent);color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:1rem;font-weight:600;transition:all .2s}.edit-drawing-btn[_ngcontent-%COMP%]:hover{background:var(--accentdark);transform:translateY(-1px);box-shadow:0 4px 8px #8b5cf64d}.checkbox-field[_ngcontent-%COMP%]{margin-bottom:.5rem}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-weight:400!important;font-size:.95rem}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer;margin:0}.checkbox-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.field[_ngcontent-%COMP%]   .color-picker[_ngcontent-%COMP%]{width:100%;height:48px;border:2px solid var(--border);border-radius:8px;cursor:pointer;background:var(--bg);transition:all .2s}.field[_ngcontent-%COMP%]   .color-picker[_ngcontent-%COMP%]:hover{border-color:var(--accent);box-shadow:0 0 15px currentColor}.spell-drawing[_ngcontent-%COMP%]{flex-shrink:0;width:150px;height:60px;border:2px solid var(--border);border-radius:4px;overflow:hidden;background:var(--card)}']})};var Ie=[{name:"Purple",value:"#8b5cf6"},{name:"Blue",value:"#3b82f6"},{name:"Cyan",value:"#06b6d4"},{name:"Green",value:"#22c55e"},{name:"Yellow",value:"#eab308"},{name:"Orange",value:"#f97316"},{name:"Red",value:"#ef4444"},{name:"Pink",value:"#ec4899"},{name:"White",value:"#ffffff"}],Be=["Fire","Water","Earth","Air","Light","Dark","Healing","Protection","Attack","Defense","Buff","Debuff","Summoning","Enchantment","Illusion","Divination"];var ft=["canvas"];function _t(s,t){if(s&1){let e=C();r(0,"button",29),m("click",function(){let i=p(e).$implicit,o=d(3);return g(o.selectColor(i))}),a()}if(s&2){let e=t.$implicit,n=d(3);H("background",e)("border-color",e==="#ffffff"?"#666":e),b("active",n.strokeColor===e),u("title",e)}}function bt(s,t){if(s&1){let e=C();r(0,"div",13)(1,"div",24),D(2,_t,1,7,"button",25,z),r(4,"label",26)(5,"input",27),m("input",function(i){p(e);let o=d(2);return g(o.onColorInput(i))}),a(),M(6,"span",28),a()()()}if(s&2){let e=d(2);l(2),R(e.presetColors),l(3),u("value",e.strokeColor),l(),H("background",e.strokeColor)}}function Ct(s,t){if(s&1){let e=C();r(0,"button",33),m("click",function(){let i=p(e).$implicit,o=d(3);return g(o.selectEraserSize(i))}),M(1,"span",34),a()}if(s&2){let e=t.$implicit,n=d(3);b("active",n.eraserSize===e),u("title",e+"px"),l(),H("width",n.Math.min(e,24),"px")("height",n.Math.min(e,24),"px")}}function xt(s,t){if(s&1&&(r(0,"div",13)(1,"span",30),c(2,"Eraser Size:"),a(),r(3,"div",31),D(4,Ct,2,7,"button",32,z),a()()),s&2){let e=d(2);l(4),R(e.eraserSizes)}}function vt(s,t){if(s&1){let e=C();r(0,"div",1)(1,"div",5)(2,"h3"),c(3),a(),r(4,"button",6),m("click",function(){p(e);let i=d();return g(i.closeFullscreenDrawing())}),c(5,"\u2715 Close"),a()(),r(6,"div",7)(7,"div",8)(8,"div",9)(9,"button",10),m("click",function(){p(e);let i=d();return g(i.setDrawMode())}),r(10,"span",11),c(11,"\u270F\uFE0F"),a()(),r(12,"button",12),m("click",function(){p(e);let i=d();return g(i.toggleEraser())}),r(13,"span",11),c(14,"\u{1F9F9}"),a()()(),h(15,bt,7,3,"div",13),h(16,xt,6,0,"div",13),r(17,"div",14)(18,"button",15),m("click",function(){p(e);let i=d();return g(i.undo())}),r(19,"span",11),c(20,"\u21B6"),a(),c(21," Undo "),a(),r(22,"button",16),m("click",function(){p(e);let i=d();return g(i.clearCanvas())}),r(23,"span",11),c(24,"\u{1F5D1}\uFE0F"),a(),c(25," Clear "),a()()(),r(26,"div",17)(27,"button",18),m("click",function(){p(e);let i=d();return g(i.expandTop())}),c(28,"\u25B2"),a(),r(29,"button",19),m("click",function(){p(e);let i=d();return g(i.expandLeft())}),c(30,"\u25C4"),a(),r(31,"button",20),m("click",function(){p(e);let i=d();return g(i.expandRight())}),c(32,"\u25BA"),a(),r(33,"button",21),m("click",function(){p(e);let i=d();return g(i.expandBottom())}),c(34,"\u25BC"),a(),r(35,"div",22)(36,"canvas",23,0),m("pointerdown",function(i){p(e);let o=d();return g(o.startDrawing(i))})("pointermove",function(i){p(e);let o=d();return g(o.draw(i))})("pointerup",function(){p(e);let i=d();return g(i.stopDrawing())})("pointerleave",function(){p(e);let i=d();return g(i.stopDrawing())})("pointercancel",function(){p(e);let i=d();return g(i.stopDrawing())}),a()()()()()}if(s&2){let e=d();l(3),y("\u2728 ",e.rune.drawing?"Edit":"Create"," Rune Drawing"),l(6),b("active",!e.isErasing()),l(3),b("active",e.isErasing()),l(3),f(e.isErasing()?-1:15),l(),f(e.isErasing()?16:-1),l(19),b("panning",e.isPanning()),l(),ne("width",e.canvasWidth())("height",e.canvasHeight())}}function wt(s,t){if(s&1&&(r(0,"span",42),c(1),a()),s&2){let e=t.$implicit;l(),T(e)}}function kt(s,t){if(s&1){let e=C();r(0,"div",3)(1,"div",35)(2,"div",36),M(3,"img",37),U(4,"imageUrl"),a(),r(5,"div",38)(6,"div",39)(7,"h4"),c(8),a(),r(9,"button",40),m("click",function(i){return p(e),d().deleteRune(),g(i.stopPropagation())}),c(10,"\u{1F5D1}\uFE0F"),a()(),r(11,"div",41),D(12,wt,2,1,"span",42,z),a()()(),M(14,"p",43),a()}if(s&2){let e=d();l(3),u("src",Z(4,3,e.rune.drawing),Y),l(5),T(e.rune.name),l(4),R(e.rune.tags),l(2),u("innerHTML",e.enhancedDescription,L)}}function yt(s,t){if(s&1&&(r(0,"div",55),M(1,"img",37),U(2,"imageUrl"),a()),s&2){let e=d(3);l(),u("src",Z(2,1,e.rune.drawing),Y)}}function Mt(s,t){if(s&1){let e=C();r(0,"div",45)(1,"label"),c(2,"Draw Rune Symbol"),a(),h(3,yt,3,3,"div",55),r(4,"button",56),m("click",function(){p(e);let i=d(2);return g(i.openFullscreenDrawing())}),c(5," \u{1F4DD} Edit Drawing in Fullscreen "),a()()}if(s&2){let e=d(2);l(3),f(e.rune.drawing?3:-1)}}function St(s,t){if(s&1){let e=C();r(0,"button",57),m("click",function(){let i=p(e).$implicit,o=d(2);return g(o.toggleTag(i))}),c(1),a()}if(s&2){let e=t.$implicit,n=d(2);b("selected",n.hasTag(e)),l(),y(" ",e," ")}}function Pt(s,t){if(s&1){let e=C();r(0,"div",44),m("click",function(i){return p(e),g(i.stopPropagation())}),r(1,"div",45)(2,"label"),c(3,"Name"),a(),r(4,"input",46),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("name",i))}),a()(),r(5,"div",45)(6,"label"),c(7,"Description"),a(),r(8,"textarea",47),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("description",i))}),a()(),r(9,"div",48)(10,"label",49)(11,"input",50),m("change",function(){p(e);let i=d();return g(i.toggleDrawing())}),a(),r(12,"span"),c(13,"Draw Rune Symbol"),a()()(),h(14,Mt,6,1,"div",45),r(15,"div",45)(16,"label"),c(17,"Tags"),a(),r(18,"div",51),D(19,St,2,3,"button",52,z),a()(),r(21,"div",53)(22,"button",54),m("click",function(){p(e);let i=d();return g(i.toggleEdit())}),c(23,"Done"),a()()()}if(s&2){let e=d();l(4),u("ngModel",e.rune.name),l(4),u("ngModel",e.rune.description),l(3),u("checked",e.hasDrawing),l(3),f(e.hasDrawing?14:-1),l(5),R(e.tagOptions)}}var Ve=class s{constructor(t,e,n){this.cd=t;this.sanitizer=e;this.imageService=n}canvasRef;rune;index;isEditing=!1;patch=new k;delete=new k;editingChange=new k;tagOptions=Be;glowColors=Ie;hasDrawing=!1;canvasWidth=P(400);canvasHeight=P(400);isErasing=P(!1);isPanning=P(!1);isFullscreenDrawing=P(!1);presetColors=["#ff0000","#ff6600","#ffcc00","#00ff00","#00ffff","#0066ff","#6600ff","#ff00ff","#ffffff","#000000"];eraserSizes=[10,20,30,40];eraserSize=20;Math=Math;canvasInitialized=!1;ctx;isDrawingOnCanvas=!1;lastX=0;lastY=0;expandAmount=200;undoHistory=[];maxUndoSteps=20;panStartX=0;panStartY=0;ngOnInit(){document.addEventListener("keydown",this.handleKeyDown.bind(this))}ngOnDestroy(){document.removeEventListener("keydown",this.handleKeyDown.bind(this))}handleKeyDown(t){(t.ctrlKey||t.metaKey)&&t.key==="z"&&this.isEditing&&this.hasDrawing&&this.isDrawingOnCanvas===!1&&(t.preventDefault(),this.undo())}ngAfterViewInit(){this.tryInitCanvas()}ngAfterViewChecked(){this.tryInitCanvas()}tryInitCanvas(){this.isEditing&&this.hasDrawing&&this.canvasRef&&!this.canvasInitialized?(this.initCanvas(),this.canvasInitialized=!0):(!this.isEditing||!this.hasDrawing)&&(this.canvasInitialized=!1)}get enhancedDescription(){let t=this.rune.description||"No description",e=W.enhance(t);return this.sanitizer.bypassSecurityTrustHtml(e)}async toggleEdit(){let t=!this.isEditing;if(this.editingChange.emit(t),t)this.hasDrawing=!!this.rune.drawing;else if(!(this.hasDrawing&&this.canvasRef&&this.isFullscreenDrawing()))if(this.hasDrawing&&this.canvasRef){let n=this.canvasRef.nativeElement.toDataURL("image/png"),i=await this.imageService.uploadImage(n);this.updateField("drawing",i)}else this.hasDrawing||this.updateField("drawing",void 0)}toggleDrawing(){this.hasDrawing=!this.hasDrawing,this.canvasInitialized=!1,this.hasDrawing?setTimeout(()=>this.openFullscreenDrawing(),0):this.updateField("drawing",void 0)}openFullscreenDrawing(){this.hasDrawing&&(this.isFullscreenDrawing.set(!0),this.canvasInitialized=!1,this.cd.detectChanges(),setTimeout(()=>{this.canvasRef&&(this.initCanvas(),this.rune.drawing&&this.loadDrawing(this.rune.drawing),this.cd.detectChanges())},0))}async closeFullscreenDrawing(){if(this.hasDrawing&&this.canvasRef){let e=this.canvasRef.nativeElement.toDataURL("image/png"),n=await this.imageService.uploadImage(e);this.updateField("drawing",n)}else this.hasDrawing||this.updateField("drawing",void 0);this.isFullscreenDrawing.set(!1)}loadDrawing(t){if(!this.ctx)return;let e=new Image;e.onload=()=>{this.ctx&&(this.ctx.clearRect(0,0,this.canvasWidth(),this.canvasHeight()),this.ctx.drawImage(e,0,0))};let n=this.imageService.getImageUrl(t);n&&(e.src=n)}get strokeColor(){return this.rune.strokeColor||"#8b5cf6"}initCanvas(){if(!this.canvasRef)return;let t=this.canvasRef.nativeElement;if(this.ctx=t.getContext("2d"),this.ctx.lineWidth=2,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.strokeStyle=this.strokeColor,this.ctx.shadowColor=this.strokeColor,this.ctx.shadowBlur=20,this.rune.drawing){let e=new Image;e.onload=()=>{this.canvasWidth.set(e.width),this.canvasHeight.set(e.height),requestAnimationFrame(()=>{this.ctx&&(this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,t.width,t.height),this.ctx.drawImage(e,0,0),this.ctx.strokeStyle=this.strokeColor,this.ctx.shadowColor=this.strokeColor,this.ctx.shadowBlur=20,this.ctx.lineWidth=2,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.saveToHistory())})},e.src=this.imageService.getImageUrl(this.rune.drawing)||""}else this.clearCanvas(),this.saveToHistory()}updateStrokeColor(t){this.updateField("strokeColor",t),this.ctx&&(this.ctx.strokeStyle=t,this.ctx.shadowColor=t)}startDrawing(t){if(this.canvasRef){if(t.button===1){t.preventDefault();let e=this.canvasRef.nativeElement.parentElement;e&&(this.isPanning.set(!0),this.panStartX=e.scrollLeft+t.clientX,this.panStartY=e.scrollTop+t.clientY);return}if(t.button===0){this.isDrawingOnCanvas=!0;let e=this.canvasRef.nativeElement.getBoundingClientRect();this.lastX=t.clientX-e.left,this.lastY=t.clientY-e.top,this.saveToHistory()}}}draw(t){if(!this.canvasRef)return;if(this.isPanning()){let _=this.canvasRef.nativeElement.parentElement;_&&(_.scrollLeft=this.panStartX-t.clientX,_.scrollTop=this.panStartY-t.clientY);return}if(!this.isDrawingOnCanvas||!this.ctx)return;let e=this.canvasRef.nativeElement.getBoundingClientRect(),n=t.clientX-e.left,i=t.clientY-e.top;this.isErasing()?(this.ctx.globalCompositeOperation="destination-out",this.ctx.lineWidth=this.eraserSize,this.ctx.shadowBlur=0):(this.ctx.globalCompositeOperation="source-over",this.ctx.lineWidth=2),(this.isErasing()?[0]:[30,20,10,5]).forEach(_=>{this.ctx.shadowBlur=_,this.ctx.beginPath(),this.ctx.moveTo(this.lastX,this.lastY),this.ctx.lineTo(n,i),this.ctx.stroke()}),this.lastX=n,this.lastY=i}stopDrawing(){this.isDrawingOnCanvas=!1,this.isPanning.set(!1)}clearCanvas(){!this.canvasRef||!this.ctx||(this.canvasWidth.set(400),this.canvasHeight.set(400),requestAnimationFrame(()=>{if(this.ctx&&this.canvasRef){let t=this.canvasRef.nativeElement;this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,t.width,t.height),this.ctx.strokeStyle=this.strokeColor,this.ctx.shadowColor=this.strokeColor,this.ctx.shadowBlur=20,this.ctx.lineWidth=2,this.undoHistory=[],this.saveToHistory()}}))}toggleEraser(){this.isErasing.set(!this.isErasing())}setDrawMode(){this.isErasing.set(!1)}selectColor(t){this.updateField("strokeColor",t),this.ctx&&(this.ctx.strokeStyle=t,this.ctx.shadowColor=t)}onColorInput(t){let e=t.target;this.selectColor(e.value)}selectEraserSize(t){this.eraserSize=t}expandLeft(){this.expandCanvas("left")}expandRight(){this.expandCanvas("right")}expandTop(){this.expandCanvas("top")}expandBottom(){this.expandCanvas("bottom")}expandCanvas(t){if(!this.canvasRef||!this.ctx)return;let e=this.canvasRef.nativeElement,n=document.createElement("canvas"),i=n.getContext("2d");n.width=e.width,n.height=e.height,i.drawImage(e,0,0);let o=this.canvasWidth(),_=this.canvasHeight(),O=o,E=_,j=0,he=0;switch(t){case"left":O=o+this.expandAmount,j=this.expandAmount;break;case"right":O=o+this.expandAmount;break;case"top":E=_+this.expandAmount,he=this.expandAmount;break;case"bottom":E=_+this.expandAmount;break}this.canvasWidth.set(O),this.canvasHeight.set(E),requestAnimationFrame(()=>{if(this.ctx&&this.canvasRef){let K=this.canvasRef.nativeElement;this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,K.width,K.height),this.ctx.drawImage(n,j,he),this.ctx.strokeStyle=this.strokeColor,this.ctx.shadowColor=this.strokeColor,this.ctx.shadowBlur=20,this.ctx.lineWidth=2}})}saveToHistory(){if(!this.canvasRef||!this.ctx)return;let t=this.canvasRef.nativeElement,e=this.ctx.getImageData(0,0,t.width,t.height);this.undoHistory.push(e),this.undoHistory.length>this.maxUndoSteps&&this.undoHistory.shift()}undo(){if(!this.canvasRef||!this.ctx||this.undoHistory.length<2)return;this.undoHistory.pop();let t=this.undoHistory[this.undoHistory.length-1];t&&(this.ctx.putImageData(t,0,0),this.ctx.strokeStyle=this.strokeColor,this.ctx.shadowColor=this.strokeColor,this.ctx.shadowBlur=20,this.ctx.lineWidth=2)}updateField(t,e){this.patch.emit({path:t,value:e}),this.cd.detectChanges()}toggleTag(t){this.rune.tags||(this.rune.tags=[]);let e=this.rune.tags.indexOf(t),n;e>-1?n=this.rune.tags.filter(i=>i!==t):n=[...this.rune.tags,t],this.updateField("tags",n)}hasTag(t){return this.rune.tags?.includes(t)||!1}deleteRune(){this.delete.emit()}static \u0275fac=function(e){return new(e||s)(S(q),S(G),S(ce))};static \u0275cmp=I({type:s,selectors:[["app-rune"]],viewQuery:function(e,n){if(e&1&&ie(ft,5),e&2){let i;re(i=ae())&&(n.canvasRef=i.first)}},inputs:{rune:"rune",index:"index",isEditing:"isEditing"},outputs:{patch:"patch",delete:"delete",editingChange:"editingChange"},decls:4,vars:4,consts:[["canvas",""],[1,"fullscreen-overlay"],[1,"rune-card",3,"dblclick"],[1,"rune-view"],[1,"rune-edit"],[1,"fullscreen-header"],["type","button",1,"close-fullscreen-btn",3,"click"],[1,"fullscreen-content"],[1,"drawing-toolbar"],[1,"toolbar-section","tools"],["type","button","title","Draw Mode",1,"toolbar-btn",3,"click"],[1,"btn-icon"],["type","button","title","Eraser Mode",1,"toolbar-btn",3,"click"],[1,"toolbar-section","brush-settings"],[1,"toolbar-section","actions"],["type","button","title","Undo (Ctrl+Z)",1,"action-btn",3,"click"],["type","button","title","Clear Drawing",1,"action-btn","clear",3,"click"],[1,"canvas-area"],["type","button","title","Expand Top",1,"expand-btn","expand-top",3,"click"],["type","button","title","Expand Left",1,"expand-btn","expand-left",3,"click"],["type","button","title","Expand Right",1,"expand-btn","expand-right",3,"click"],["type","button","title","Expand Bottom",1,"expand-btn","expand-bottom",3,"click"],[1,"fullscreen-canvas-wrapper"],[3,"pointerdown","pointermove","pointerup","pointerleave","pointercancel"],[1,"color-picker"],["type","button",1,"color-swatch",3,"active","background","border-color","title"],["title","Custom Color",1,"custom-color"],["type","color",3,"input","value"],[1,"custom-color-preview"],["type","button",1,"color-swatch",3,"click","title"],[1,"setting-label"],[1,"size-picker"],["type","button",1,"size-btn",3,"active","title"],["type","button",1,"size-btn",3,"click","title"],[1,"size-dot"],[1,"rune-header"],[1,"rune-drawing"],["alt","Rune drawing",3,"src"],[1,"rune-info"],[1,"rune-title-row"],["title","Delete",1,"delete-btn-compact",3,"click"],[1,"rune-tags"],[1,"tag"],[1,"rune-description",3,"innerHTML"],[1,"rune-edit",3,"click"],[1,"field"],["type","text",3,"ngModelChange","ngModel"],["rows","3",3,"ngModelChange","ngModel"],[1,"field","checkbox-field"],[1,"checkbox-label"],["type","checkbox",3,"change","checked"],[1,"tag-selector"],["type","button",1,"tag-option",3,"selected"],[1,"rune-actions"],[1,"save-btn",3,"click"],[1,"drawing-preview"],["type","button",1,"edit-drawing-btn",3,"click"],["type","button",1,"tag-option",3,"click"]],template:function(e,n){e&1&&(h(0,vt,38,11,"div",1),r(1,"div",2),m("dblclick",function(){return!n.isEditing&&n.toggleEdit()}),h(2,kt,15,5,"div",3)(3,Pt,24,4,"div",4),a()),e&2&&(f(n.isEditing&&n.hasDrawing&&n.isFullscreenDrawing()?0:-1),l(),b("editing",n.isEditing),l(),f(n.isEditing?3:2))},dependencies:[B,N,V,A,F,de],styles:['[_nghost-%COMP%]{display:block;width:100%}.rune-card[_ngcontent-%COMP%]{background:var(--card);border:1px solid var(--border);border-radius:6px;padding:1rem;transition:all .2s;border-left:3px solid #9c27b0;cursor:grab;width:100%;box-sizing:border-box}.rune-card[_ngcontent-%COMP%]:active{cursor:grabbing}.rune-card.editing[_ngcontent-%COMP%]{cursor:default;border-color:var(--muted)}.rune-card[_ngcontent-%COMP%]:not(.editing):hover{box-shadow:0 2px 6px #0000001f;border-color:var(--accent);transform:translateY(-1px)}.rune-header[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:.5rem;align-items:flex-start}.rune-drawing[_ngcontent-%COMP%]{flex-shrink:0;width:80px;height:80px;border:2px solid var(--border);border-radius:4px;overflow:hidden;background:#000}.rune-drawing[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain}.rune-info[_ngcontent-%COMP%]{flex:1;min-width:0}.rune-title-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:.5rem}.rune-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.1rem;color:var(--text);word-break:break-word;flex:1}.delete-btn-compact[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--border);color:var(--text);border-radius:4px;cursor:pointer;font-size:1.2rem;padding:.25rem .5rem;transition:all .2s;flex-shrink:0}.delete-btn-compact[_ngcontent-%COMP%]:hover{background:#f44336;border-color:#f44336;color:#fff;transform:scale(1.1)}.rune-tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.25rem}.tag[_ngcontent-%COMP%]{background:#1976d233;color:#64b5f6;padding:.2rem .5rem;border-radius:3px;font-size:.75rem;border:1px solid rgba(25,118,210,.4)}.rune-description[_ngcontent-%COMP%]{color:var(--text);margin:.5rem 0 0;font-size:.9rem;line-height:1.5;word-wrap:break-word;overflow-wrap:break-word;white-space:pre-wrap}.rune-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.75rem}.rune-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;transition:all .2s;flex:1;font-weight:600}.save-btn[_ngcontent-%COMP%]{background-color:var(--accent);color:#fff}.save-btn[_ngcontent-%COMP%]:hover{background-color:var(--accentdark);transform:translateY(-1px);box-shadow:0 2px 4px #4caf504d}.delete-btn[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#e53935;transform:translateY(-1px);box-shadow:0 2px 4px #f443364d}.field[_ngcontent-%COMP%]{margin-bottom:1rem}.checkbox-field[_ngcontent-%COMP%]{margin-bottom:.5rem}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-weight:400!important;font-size:.95rem}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer;margin:0}.checkbox-label[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.25rem;font-weight:500;font-size:.9rem;color:var(--text)}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid var(--border);border-radius:4px;font-family:inherit;font-size:.9rem;box-sizing:border-box;background:var(--bg);color:var(--text)}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--accent)}.field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical}.tag-selector[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.tag-option[_ngcontent-%COMP%]{padding:.4rem .8rem;background:var(--bg);color:var(--text);border:1px solid var(--border);border-radius:4px;cursor:pointer;font-size:.85rem;transition:all .2s}.tag-option[_ngcontent-%COMP%]:hover{background:var(--card);border-color:var(--accent)}.tag-option.selected[_ngcontent-%COMP%]{background:#1976d233;color:#64b5f6;border-color:#1976d266}.rune-edit[_ngcontent-%COMP%]{pointer-events:all}.canvas-wrapper[_ngcontent-%COMP%]{margin-top:.5rem}.drawing-toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap;gap:1rem;padding:.5rem 1rem;background:var(--card);border:1px solid var(--border);border-radius:8px;margin-bottom:.5rem}.toolbar-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.toolbar-section.tools[_ngcontent-%COMP%]{background:var(--bg);padding:.25rem;border-radius:8px}.toolbar-btn[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:8px;background:transparent;border:1px solid transparent;color:var(--text);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.toolbar-btn[_ngcontent-%COMP%]:hover{background:var(--border)}.toolbar-btn.active[_ngcontent-%COMP%]{background:var(--accent);border-color:var(--accent);color:#fff;box-shadow:0 0 10px #8b5cf666}.btn-icon[_ngcontent-%COMP%]{font-size:1.4rem}.brush-settings[_ngcontent-%COMP%]{background:var(--bg);padding:.5rem;border-radius:8px;gap:1rem}.setting-label[_ngcontent-%COMP%]{font-size:.85rem;color:var(--text);font-weight:500}.color-picker[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.color-swatch[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:all .2s}.color-swatch[_ngcontent-%COMP%]:hover{transform:scale(1.15)}.color-swatch.active[_ngcontent-%COMP%]{border-color:#fff;box-shadow:0 0 0 2px var(--accent);transform:scale(1.1)}.custom-color[_ngcontent-%COMP%]{position:relative;width:28px;height:28px;cursor:pointer}.custom-color[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:absolute;opacity:0;width:100%;height:100%;cursor:pointer}.custom-color-preview[_ngcontent-%COMP%]{display:block;width:100%;height:100%;border-radius:50%;border:2px dashed var(--border);background:conic-gradient(red,#ff0,#0f0,#0ff,#00f,#f0f,red)}.size-picker[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem}.size-btn[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:6px;background:transparent;border:1px solid transparent;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.size-btn[_ngcontent-%COMP%]:hover{background:var(--border)}.size-btn.active[_ngcontent-%COMP%]{background:var(--accent);border-color:var(--accent)}.size-dot[_ngcontent-%COMP%]{border-radius:50%;background:var(--text);max-width:24px;max-height:24px}.size-btn.active[_ngcontent-%COMP%]   .size-dot[_ngcontent-%COMP%]{background:#fff}.toolbar-section.actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.action-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;background:var(--bg);border:1px solid var(--border);border-radius:6px;cursor:pointer;font-size:.9rem;color:var(--text);transition:all .2s;display:flex;align-items:center;gap:.25rem}.action-btn[_ngcontent-%COMP%]:hover{background:var(--border)}.action-btn.clear[_ngcontent-%COMP%]:hover{background:#f44;color:#fff;border-color:#f44}.canvas-area[_ngcontent-%COMP%]{position:relative;display:inline-block;margin:1rem 0;padding:25px}.expand-btn[_ngcontent-%COMP%]{position:absolute;background:var(--card);border:2px solid var(--border);border-radius:6px;cursor:pointer;font-size:1.2rem;transition:all .2s;color:var(--text);z-index:10;padding:.4rem;display:flex;align-items:center;justify-content:center;min-width:36px;min-height:36px}.expand-btn[_ngcontent-%COMP%]:hover{background:var(--accent);color:#fff;border-color:var(--accent);transform:scale(1.1)}.expand-btn.expand-top[_ngcontent-%COMP%]{top:-20px;left:50%;transform:translate(-50%)}.expand-btn.expand-bottom[_ngcontent-%COMP%]{bottom:-20px;left:50%;transform:translate(-50%)}.expand-btn.expand-left[_ngcontent-%COMP%]{left:-20px;top:50%;transform:translateY(-50%)}.expand-btn.expand-right[_ngcontent-%COMP%]{right:-20px;top:50%;transform:translateY(-50%)}.expand-btn.expand-top[_ngcontent-%COMP%]:hover, .expand-btn.expand-bottom[_ngcontent-%COMP%]:hover{transform:translate(-50%) scale(1.1)}.expand-btn.expand-left[_ngcontent-%COMP%]:hover, .expand-btn.expand-right[_ngcontent-%COMP%]:hover{transform:translateY(-50%) scale(1.1)}.canvas-container[_ngcontent-%COMP%]{border:2px solid var(--border);background:#000;display:inline-block;border-radius:8px;overflow:auto;max-width:100%;max-height:70vh;box-shadow:0 2px 4px #0000001a;touch-action:none}.canvas-container.panning[_ngcontent-%COMP%]{cursor:grab}.canvas-container.panning[_ngcontent-%COMP%]:active{cursor:grabbing}canvas[_ngcontent-%COMP%]{display:block;cursor:crosshair;background:#000;touch-action:none}.color-selector[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:.5rem}.color-option[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;border:2px solid var(--border);cursor:pointer;transition:all .2s;position:relative}.color-option[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.color-option.selected[_ngcontent-%COMP%]{border-color:var(--text);box-shadow:0 0 8px currentColor}.color-option.selected[_ngcontent-%COMP%]:after{content:"\\2713";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#000;font-size:14px;font-weight:700;text-shadow:0 0 2px #fff}.color-picker[_ngcontent-%COMP%]{width:100%;height:48px;border:2px solid var(--border);border-radius:8px;cursor:pointer;background:var(--bg);transition:all .2s}.color-picker[_ngcontent-%COMP%]:hover{border-color:var(--accent);box-shadow:0 0 15px currentColor}.clear-btn[_ngcontent-%COMP%]{margin-top:.5rem;padding:.5rem 1rem;background:#ff9800;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:.85rem;font-weight:600;transition:all .2s}.clear-btn[_ngcontent-%COMP%]:hover{background:#f57c00;transform:translateY(-1px);box-shadow:0 2px 4px #ff98004d}.fullscreen-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000f2;z-index:10000;display:flex;flex-direction:column}.fullscreen-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;background:#ffffff1a;border-bottom:1px solid rgba(255,255,255,.2)}.fullscreen-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#fff;font-size:1.5rem}.close-fullscreen-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#ff5252;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:1rem;font-weight:600;transition:all .2s}.close-fullscreen-btn[_ngcontent-%COMP%]:hover{background:#ff1744;transform:translateY(-1px);box-shadow:0 4px 8px #ff525266}.fullscreen-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;padding:2rem;overflow:auto;width:100%}.fullscreen-canvas-wrapper[_ngcontent-%COMP%]{background:#000;border:2px solid rgba(255,255,255,.3);border-radius:8px;overflow:auto;max-width:95vw;max-height:calc(95vh - 150px);box-shadow:0 8px 32px #0009}.fullscreen-canvas-wrapper[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{display:block;cursor:crosshair;touch-action:none}.fullscreen-canvas-wrapper.panning[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{cursor:grab}.fullscreen-canvas-wrapper.panning[_ngcontent-%COMP%]:active   canvas[_ngcontent-%COMP%]{cursor:grabbing}.drawing-preview[_ngcontent-%COMP%]{margin-bottom:1rem;border:2px solid var(--border);border-radius:8px;padding:1rem;background:#000;max-width:300px}.drawing-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;display:block}.edit-drawing-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:var(--accent);color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:1rem;font-weight:600;transition:all .2s}.edit-drawing-btn[_ngcontent-%COMP%]:hover{background:var(--accentdark);transform:translateY(-1px);box-shadow:0 4px 8px #8b5cf64d}']})};function Ot(s,t){s&1&&(r(0,"span",8),c(1,"Enlightened"),a())}function Et(s,t){if(s&1){let e=C();r(0,"div",3),m("dblclick",function(){p(e);let i=d();return g(!i.isEditing&&i.toggleEdit())}),r(1,"div",4)(2,"h4"),c(3),a(),r(4,"div",5)(5,"span",6),c(6),a(),r(7,"span",7),c(8),a(),h(9,Ot,2,0,"span",8),r(10,"button",9),m("click",function(i){return p(e),d().deleteSkill(),g(i.stopPropagation())})("dblclick",function(i){return p(e),g(i.stopPropagation())}),c(11,"\u{1F5D1}\uFE0F"),a()()(),M(12,"p",10),a()}if(s&2){let e=d();l(3),T(e.skill.name),l(2),b("active",e.effectiveType==="active")("passive",e.effectiveType==="passive")("dice-bonus",e.effectiveType==="dice_bonus")("stat-bonus",e.effectiveType==="stat_bonus"),l(),y(" ",e.getTypeLabel(e.effectiveType)," "),l(),b("disabled",e.isDisabled),l(),y(" ",e.skill.class," "),l(),f(e.skill.enlightened?9:-1),l(3),u("innerHTML",e.enhancedDescription,L)}}function zt(s,t){if(s&1){let e=C();r(0,"div",11),m("click",function(i){return p(e),g(i.stopPropagation())}),r(1,"div",12)(2,"label"),c(3,"Name"),a(),r(4,"input",13),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("name",i))}),a()(),r(5,"div",12)(6,"label"),c(7,"Class"),a(),r(8,"input",13),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("class",i))}),a()(),r(9,"div",12)(10,"label"),c(11,"Type"),a(),r(12,"select",14),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("type",i))}),r(13,"option",15),c(14,"Active"),a(),r(15,"option",16),c(16,"Passive"),a(),r(17,"option",17),c(18,"Dice Bonus"),a(),r(19,"option",18),c(20,"Stat Bonus"),a()()(),r(21,"div",19)(22,"label")(23,"input",20),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("enlightened",i))}),a(),c(24," Enlightened "),a()(),r(25,"div",12)(26,"label"),c(27,"Description"),a(),r(28,"textarea",21),m("ngModelChange",function(i){p(e);let o=d();return g(o.updateField("description",i))}),a()(),r(29,"div",22)(30,"button",23),m("click",function(){p(e);let i=d();return g(i.toggleEdit())}),c(31,"Done"),a()()()}if(s&2){let e=d();l(4),u("ngModel",e.skill.name),l(4),u("ngModel",e.skill.class),l(4),u("ngModel",e.skill.type),l(11),u("ngModel",e.skill.enlightened),l(5),u("ngModel",e.skill.description)}}var Ae=class s{constructor(t,e){this.cd=t;this.sanitizer=e}skill;sheet;index;isEditing=!1;patch=new k;delete=new k;editingChange=new k;get effectiveType(){let t=fe.find(e=>e.name===this.skill.name);return t?t.type:this.skill.type}get isDisabled(){return this.skill.enlightened?!1:!ge.isClassEnabled(this.skill.class,this.sheet.primary_class,this.sheet.secondary_class)}get enhancedDescription(){let t=this.skill.description||"No description",e=W.enhance(t);return this.sanitizer.bypassSecurityTrustHtml(e)}toggleEdit(){this.editingChange.emit(!this.isEditing)}updateField(t,e){this.patch.emit({path:t,value:e}),this.cd.detectChanges()}deleteSkill(){this.delete.emit()}getTypeLabel(t){return{active:"Active",passive:"Passive",dice_bonus:"Dice Bonus",stat_bonus:"Stat Bonus"}[t]||t}static \u0275fac=function(e){return new(e||s)(S(q),S(G))};static \u0275cmp=I({type:s,selectors:[["app-skill"]],inputs:{skill:"skill",sheet:"sheet",index:"index",isEditing:"isEditing"},outputs:{patch:"patch",delete:"delete",editingChange:"editingChange"},decls:3,vars:13,consts:[[1,"skill-card"],[1,"skill-view"],[1,"skill-edit"],[1,"skill-view",3,"dblclick"],[1,"skill-header"],[1,"skill-badges"],[1,"skill-type"],[1,"skill-class"],[1,"skill-enlightened"],["title","Delete",1,"delete-btn-compact",3,"click","dblclick"],[1,"skill-description",3,"innerHTML"],[1,"skill-edit",3,"click"],[1,"field"],["type","text",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["value","active"],["value","passive"],["value","dice_bonus"],["value","stat_bonus"],[1,"field","checkbox-field"],["type","checkbox",3,"ngModelChange","ngModel"],["rows","3",3,"ngModelChange","ngModel"],[1,"skill-actions"],[1,"save-btn",3,"click"]],template:function(e,n){e&1&&(r(0,"div",0),h(1,Et,13,15,"div",1)(2,zt,32,5,"div",2),a()),e&2&&(b("editing",n.isEditing)("passive",n.effectiveType==="passive")("active",n.effectiveType==="active")("dice-bonus",n.effectiveType==="dice_bonus")("stat-bonus",n.effectiveType==="stat_bonus")("disabled",n.isDisabled),l(),f(n.isEditing?2:1))},dependencies:[B,N,se,le,V,X,oe,A,F],styles:["[_nghost-%COMP%]{display:block;width:100%}.skill-card[_ngcontent-%COMP%]{background:var(--card);border:1px solid var(--border);border-radius:6px;padding:1rem;transition:all .2s;border-left:5px solid #eab308;cursor:grab;width:100%;box-sizing:border-box}.skill-card[_ngcontent-%COMP%]:active{cursor:grabbing}.skill-card.editing[_ngcontent-%COMP%]{cursor:default}.skill-card.active[_ngcontent-%COMP%]{border-left:5px solid #eab308;background:linear-gradient(135deg,var(--card) 0%,rgba(234,179,8,.1) 100%)}.skill-card.passive[_ngcontent-%COMP%]{border-left:5px solid #9b59b6;background:linear-gradient(135deg,var(--card) 0%,rgba(155,89,182,.1) 100%)}.skill-card.dice-bonus[_ngcontent-%COMP%]{border-left:5px solid #22c55e;background:linear-gradient(135deg,var(--card) 0%,rgba(34,197,94,.1) 100%)}.skill-card.stat-bonus[_ngcontent-%COMP%]{border-left:5px solid #3b82f6;background:linear-gradient(135deg,var(--card) 0%,rgba(59,130,246,.1) 100%)}.skill-card.disabled[_ngcontent-%COMP%]{opacity:.6;background:var(--bg)}.skill-card.disabled[_ngcontent-%COMP%]   .skill-class[_ngcontent-%COMP%]{opacity:1}.skill-card[_ngcontent-%COMP%]:not(.editing):hover{box-shadow:0 2px 6px #0000001f;border-color:var(--accent);transform:translateY(-1px)}.skill-card.editing[_ngcontent-%COMP%]{background:var(--card);border-color:var(--muted);opacity:1;cursor:default}.skill-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem;gap:1rem}.skill-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;color:var(--text);word-break:break-word;flex:1;min-width:0}.skill-badges[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap;flex-shrink:0}.delete-btn-compact[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--border);color:var(--text);border-radius:4px;cursor:pointer;font-size:1.2rem;padding:.25rem .5rem;transition:all .2s;flex-shrink:0}.delete-btn-compact[_ngcontent-%COMP%]:hover{background:#f44336;border-color:#f44336;color:#fff;transform:scale(1.1)}.skill-type[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:3px;font-size:.8rem;font-weight:600;white-space:nowrap}.skill-type.active[_ngcontent-%COMP%]{background:#eab308;color:#fff;border:1px solid #ca8a04}.skill-type.passive[_ngcontent-%COMP%]{background:#9b59b6;color:#fff;border:1px solid #7d3c98}.skill-type.dice-bonus[_ngcontent-%COMP%]{background:#22c55e;color:#fff;border:1px solid #16a34a}.skill-type.stat-bonus[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;border:1px solid #2563eb}.skill-class[_ngcontent-%COMP%]{background:var(--bg);color:var(--text);padding:.25rem .5rem;border-radius:3px;font-size:.8rem;border:1px solid var(--border);position:relative;white-space:nowrap}.skill-class.disabled[_ngcontent-%COMP%]{background:#f4433633;color:#ef5350;border-color:#f4433666;text-decoration:line-through}.skill-enlightened[_ngcontent-%COMP%]{background:#2e7d3233;color:#81c784;padding:.25rem .5rem;border-radius:3px;font-size:.8rem;font-weight:600;border:1px solid rgba(46,125,50,.4);white-space:nowrap}.skill-description[_ngcontent-%COMP%]{color:var(--text);margin:.5rem 0;font-size:.9rem;line-height:1.5;word-wrap:break-word;overflow-wrap:break-word;white-space:pre-wrap}.skill-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-top:.75rem}.skill-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;transition:all .2s;flex:1;font-weight:600}.save-btn[_ngcontent-%COMP%]{background-color:var(--accent);color:#fff}.save-btn[_ngcontent-%COMP%]:hover{background-color:var(--accentdark);transform:translateY(-1px);box-shadow:0 2px 4px #1200244d}.delete-btn[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#e53935;transform:translateY(-1px);box-shadow:0 2px 4px #f443364d}.field[_ngcontent-%COMP%]{margin-bottom:1rem}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.25rem;font-weight:500;font-size:.9rem;color:var(--text)}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid var(--border);border-radius:4px;font-family:inherit;font-size:.9rem;box-sizing:border-box;background:var(--bg);color:var(--text)}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .field[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--accent)}.field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical}.checkbox-field[_ngcontent-%COMP%]{flex-direction:row!important;align-items:center}.checkbox-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;margin-bottom:0}.checkbox-field[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:auto;cursor:pointer}.skill-edit[_ngcontent-%COMP%]{pointer-events:all}"]})};export{Vt as a,Pe as b,Oe as c,fe as d,Lt as e,ge as f,ze as g,Ee as h,Re as i,Te as j,Be as k,Ve as l,Ae as m};
