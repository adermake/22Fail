<form (ngSubmit)="createRune()" class="creator-form">
  <div class="field">
    <label for="name">Rune Name *</label>
    <input
      id="name"
      type="text"
      [(ngModel)]="newRune.name"
      name="name"
      placeholder="Enter rune name"
      required
    />
  </div>

  <div class="field">
    <label>Draw Rune</label>
    
    <!-- Drawing Toolbar -->
    <div class="drawing-toolbar">
      <!-- Tool Selector -->
      <div class="toolbar-section tools">
        <button 
          type="button"
          class="toolbar-btn"
          [class.active]="!isErasing()"
          title="Draw Mode"
          (click)="setDrawMode()"
        >
          <span class="btn-icon">‚úèÔ∏è</span>
        </button>
        <button 
          type="button"
          class="toolbar-btn"
          [class.active]="isErasing()"
          title="Eraser Mode"
          (click)="toggleEraser()"
        >
          <span class="btn-icon">üßπ</span>
        </button>
      </div>

      <!-- Draw Tool Settings -->
      @if (!isErasing()) {
        <div class="toolbar-section brush-settings">
          <!-- Color picker -->
          <div class="color-picker">
            @for (color of presetColors; track color) {
              <button 
                type="button"
                class="color-swatch"
                [class.active]="strokeColor === color"
                [style.background]="color"
                [style.border-color]="color === '#ffffff' ? '#666' : color"
                [title]="color"
                (click)="selectColor(color)"
              ></button>
            }
            <label class="custom-color" title="Custom Color">
              <input 
                type="color" 
                [value]="strokeColor"
                (input)="onColorInput($event)"
              />
              <span class="custom-color-preview" [style.background]="strokeColor"></span>
            </label>
          </div>
        </div>
      }

      <!-- Eraser Settings -->
      @if (isErasing()) {
        <div class="toolbar-section brush-settings">
          <span class="setting-label">Eraser Size:</span>
          <div class="size-picker">
            @for (size of eraserSizes; track size) {
              <button 
                type="button"
                class="size-btn"
                [class.active]="eraserSize === size"
                [title]="size + 'px'"
                (click)="selectEraserSize(size)"
              >
                <span class="size-dot" [style.width.px]="Math.min(size, 24)" [style.height.px]="Math.min(size, 24)"></span>
              </button>
            }
          </div>
        </div>
      }

      <!-- Actions -->
      <div class="toolbar-section actions">
        <button type="button" class="action-btn" (click)="undo()" title="Undo (Ctrl+Z)">
          <span class="btn-icon">‚Ü∂</span> Undo
        </button>
        <button type="button" class="action-btn clear" (click)="clearCanvas()" title="Clear Drawing">
          <span class="btn-icon">üóëÔ∏è</span> Clear
        </button>
      </div>
    </div>

    <!-- Canvas with border expansion buttons -->
    <div class="canvas-area">
      <button type="button" class="expand-btn expand-top" (click)="expandTop()" title="Expand Top">‚ñ≤</button>
      <button type="button" class="expand-btn expand-left" (click)="expandLeft()" title="Expand Left">‚óÑ</button>
      <button type="button" class="expand-btn expand-right" (click)="expandRight()" title="Expand Right">‚ñ∫</button>
      <button type="button" class="expand-btn expand-bottom" (click)="expandBottom()" title="Expand Bottom">‚ñº</button>
      
      <div class="canvas-container" [class.panning]="isPanning()" [style.box-shadow]="'0 0 15px ' + strokeColor + '40'">
        <canvas 
          #canvas
          [attr.width]="canvasWidth()"
          [attr.height]="canvasHeight()"
          (pointerdown)="startDrawing($event)"
          (pointermove)="draw($event)"
          (pointerup)="stopDrawing()"
          (pointerleave)="stopDrawing()"
          (pointercancel)="stopDrawing()"
        ></canvas>
      </div>
    </div>
  </div>

  <div class="field">
    <label for="description">Description</label>
    <textarea
      id="description"
      [(ngModel)]="newRune.description"
      name="description"
      rows="4"
      placeholder="Describe the rune's power..."
    ></textarea>
  </div>

  <div class="field">
    <label>Tags</label>
    <div class="tag-selector">
      @for (tag of tagOptions; track tag) {
        <button 
          type="button"
          class="tag-option" 
          [class.selected]="hasTag(tag)"
          (click)="toggleTag(tag)">
          {{ tag }}
        </button>
      }
    </div>
  </div>

  <div class="button-group">
    <button type="submit" class="create-btn">Create</button>
    <button type="button" class="cancel-btn" (click)="cancelCreate()">Cancel</button>
  </div>
</form>